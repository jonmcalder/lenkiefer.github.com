theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=cpi6n[date==dd[i] & !(item.name %in% c("Transportation","Services","Other goods and services"))],aes(x=item.name,y=cpi12,color=cpi12))+
scale_color_viridis(option="A",name="Annual Inflation\nRate (%) ",discrete=F,direction=1,end=0.85,
label=percent,limits=c(-0.01,.05))+
geom_segment(aes(xend=item.name,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=1))+
scale_y_continuous(label=percent,limits=c(-0.02,.05),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=cpi6n[date==dd[i] & !(item.name %in% c("Transportation","Services","Other goods and services"))],aes(x=item.name,y=cpi12,color=cpi12))+
scale_color_viridis(option="A",name="Annual Inflation\nRate (%) ",discrete=F,direction=1,end=0.85,
label=percent,limits=c(-0.01,.05))+
geom_segment(aes(xend=item.name,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=1)+
scale_y_continuous(label=percent,limits=c(-0.02,.05),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=cpi6n[date==dd[i] & !(item.name %in% c("Transportation","Services","Other goods and services"))],aes(x=item.name,y=cpi12,color=cpi12))+
scale_color_viridis(option="A",name="Annual Inflation\nRate (%) ",discrete=F,direction=1,end=0.85,
label=percent,limits=c(-0.01,.05))+
geom_segment(aes(xend=item.name,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3))+
scale_y_continuous(label=percent,limits=c(-0.02,.05),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=cpi6n[date==dd[i] & !(item.name %in% c("Transportation","Services","Other goods and services"))],aes(x=item.name,y=cpi12,color=cpi12))+
scale_color_viridis(option="A",name="Annual Inflation\nRate (%) ",discrete=F,direction=1,end=0.85,
label=percent,limits=c(-0.01,.05))+
geom_segment(aes(xend=item.name,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width== unit(5,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.02,.05),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=cpi6n[date==dd[i] & !(item.name %in% c("Transportation","Services","Other goods and services"))],aes(x=item.name,y=cpi12,color=cpi12))+
scale_color_viridis(option="A",name="Annual Inflation\nRate (%) ",discrete=F,direction=1,end=0.85,
label=percent,limits=c(-0.01,.05))+
geom_segment(aes(xend=item.name,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(5,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.02,.05),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=cpi6n[date==dd[i] & !(item.name %in% c("Transportation","Services","Other goods and services"))],aes(x=item.name,y=cpi12,color=cpi12))+
scale_color_viridis(option="A",name="Annual Inflation\nRate (%) ",discrete=F,direction=1,end=0.85,
label=percent,limits=c(-0.01,.05))+
geom_segment(aes(xend=item.name,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.02,.05),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=cpi6n[date==dd[i] & !(item.name %in% c("Transportation","Services","Other goods and services"))],aes(x=item.name,y=cpi12,color=cpi12))+
scale_color_viridis(option="A",name="Annual Inflation\nRate (%) ",discrete=F,direction=1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.name,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.02,.05),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
d.list3<-unique(cpi6n[month==10]$date)
d.list3
myf3<-function(d){as.data.frame(cpi7n[date==d, list(date,cpi12,item)])}
d.list3<-unique(cpi6n[month==10]$date)
my.list3<-lapply(c(d.list3,d.list3[1]),myf3)
tf3 <- tween_states(my.list3, tweenlength= 2, statelength=3, ease=rep('cubic-in-out',24),nframes=150)
tf3<-data.table(tf3)
cpi7n<-cpi6n[ !(item.name %in% c("Transportation","Services","Other goods and services"))]
myf3<-function(d){as.data.frame(cpi7n[date==d, list(date,cpi12,item)])}
d.list3<-unique(cpi6n[month==10]$date)
my.list3<-lapply(c(d.list3,d.list3[1]),myf3)
tf3 <- tween_states(my.list3, tweenlength= 2, statelength=3, ease=rep('cubic-in-out',24),nframes=150)
tf3<-data.table(tf3)
names(cpi7n)
str(cpi7n)
cpi7n<-cpi6n[ !(item.name %in% c("Transportation","Services","Other goods and services"))]
cpi7n$item.namef<-as.factor(cpi7n$item.name)
str(cpi7n)
levels(cpi7n$item.name)
levels(cpi7n$item.namef)
cpi7n<-cpi6n[ !(item.name %in% c("Transportation","Services","Other goods and services"))]
cpi7n$item.namef<-as.factor(cpi7n$item.name)
myf3<-function(d){as.data.frame(cpi7n[date==d, list(date,cpi12,item.namef)])}
d.list3<-unique(cpi6n[month==10]$date)
my.list3<-lapply(c(d.list3,d.list3[1]),myf3)
tf3 <- tween_states(my.list3, tweenlength= 2, statelength=3, ease=rep('cubic-in-out',24),nframes=150)
tf3<-data.table(tf3)
tf3
i<-176
cpi7n<-cpi6n[ !(item.name %in% c("Transportation","Services","Other goods and services"))]
cpi7n$item.namef<-as.factor(cpi7n$item.name)
cpi7n$datef<-as.factor(cpi7n$date)
myf3<-function(d){as.data.frame(cpi7n[date==d, list(datef,cpi12,item.namef)])}
d.list3<-unique(cpi6n[month==10]$date)
my.list3<-lapply(c(d.list3,d.list3[1]),myf3)
tf3 <- tween_states(my.list3, tweenlength= 2, statelength=3, ease=rep('cubic-in-out',24),nframes=150)
tf3<-data.table(tf3)
tf3
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="A",name="Annual Inflation\nRate (%) ",discrete=F,direction=1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.02,.05),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
i
tf3[.frame==i]
d.list3<-unique(cpi6n[month==10 & year>2000]$date)
d.list3
my.list3<-lapply(c(d.list3,d.list3[1]),myf3)
tf3 <- tween_states(my.list3, tweenlength= 2, statelength=3, ease=rep('cubic-in-out',24),nframes=150)
tf3<-data.table(tf3)
tf3
i
i<-166
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="A",name="Annual Inflation\nRate (%) ",discrete=F,direction=1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.02,.05),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
summary(tf)
summarytf3
summary(tf3)
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.04,.08),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=cpi6n[date==dd[i] & !(item.name %in% c("Transportation","Services","Other goods and services"))],aes(x=item.name,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.name,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.02,.05),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.04,.08),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.04,.08),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle=paste("by major category:",tf3[.frame==i]$datef,
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
)
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.04,.08),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle=paste("by major category:",tf3[.frame==i]$datef),
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.04,.08),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle=paste("by major category:",as.character(tf3[.frame==i]$datef,format="%b-%Y")),
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.04,.08),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle=paste("by major category:",as.character(as.Date(tf3[.frame==i]$datef),format="%b-%Y")),
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
getwd(0)
getwd()
setwd('C:/Users/Leonard/Documents/Data Viz/blog/cpi')
oopt = ani.options(interval = 0.1)
saveGIF({for (i in 1:max(tf3$.frame)) {
g<-
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.04,.08),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle=paste("by major category:",as.character(as.Date(tf3[.frame==i]$datef),format="%b-%Y")),
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
print(g)
ani.pause()
print(i)
}
},movie.name="cpi_dance_lolly_11_21_2016.gif",ani.width = 650, ani.height = 450)
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(2,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.04,.08),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle=paste("by major category:",as.character(as.Date(tf3[.frame==i]$datef),format="%b-%Y")),
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent,limits=c(-0.04,.08))+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(2,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.04,.08),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle=paste("by major category:",as.character(as.Date(tf3[.frame==i]$datef),format="%b-%Y")),
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
oopt = ani.options(interval = 0.1)
saveGIF({for (i in 1:max(tf3$.frame)) {
g<-
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent,limits=c(-0.04,.08))+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(2,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.04,.08),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle=paste("by major category:",as.character(as.Date(tf3[.frame==i]$datef),format="%b-%Y")),
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
print(g)
ani.pause()
print(i)  #counter
}
},movie.name="cpi_dance_lolly_11_21_2016.gif",ani.width = 650, ani.height = 450)
i<-length(dd)  #set index to last date
ggplot(data=cpi6n[date==dd[i] & !(item.name %in% c("Transportation","Services","Other goods and services"))],aes(x=item.name,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.name,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(cpi12,1)," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.02,.05),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
services"))],aes(x=item.name,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.name,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(round(cpi12,3))," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.02,.05),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
ggplot(data=cpi6n[date==dd[i] & !(item.name %in% c("Transportation","Services","Other goods and services"))],aes(x=item.name,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent)+
geom_segment(aes(xend=item.name,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(round(cpi12,3))," "),hjust=ifelse(cpi12>0,0,1)))+
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(3,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.02,.05),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle="by major category",
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
saveGIF({for (i in 1:max(tf3$.frame)) {
g<-
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent,limits=c(-0.04,.08))+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(round(cpi12,3))," "),
hjust=ifelse(cpi12>0,0,1)))+  #flip justification if point postiive or negative
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(2,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.04,.08),breaks=seq(-0.2,.05,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle=paste("by major category:",as.character(as.Date(tf3[.frame==i]$datef),format="%b-%Y")),
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
print(g)
ani.pause()
print(i)  #counter
}
},movie.name="cpi_dance_lolly_11_21_2016.gif",ani.width = 650, ani.height = 450)
oopt = ani.options(interval = 0.1)
saveGIF({for (i in 1:max(tf3$.frame)) {
g<-
ggplot(data=tf3[.frame==i],aes(x=item.namef,y=cpi12,color=cpi12))+
scale_color_viridis(option="D",name="Annual Inflation\nRate (%) ",discrete=F,direction=-1,end=0.85,
label=percent,limits=c(-0.04,.08))+
geom_segment(aes(xend=item.namef,yend=0),size=1.2)+coord_flip()+
geom_text(aes(label=paste(" ",percent(round(cpi12,3))," "),
hjust=ifelse(cpi12>0,0,1)))+  #flip justification if point postiive or negative
geom_point(size=3)+
theme_minimal()+
theme(legend.position="top",legend.text=element_text(size=7))+
theme(legend.key.width=unit(2,"cm"))+
scale_y_continuous(label=percent,limits=c(-0.04,.08),breaks=seq(-0.2,.08,.01))  +
labs(x="", y="Consumer Price Index (y/y % change NSA)",
title="Consumer Price Inflation (y/y %)",
subtitle=paste("by major category:",as.character(as.Date(tf3[.frame==i]$datef),format="%b-%Y")),
caption="@lenkiefer Source: U.S. Bureau of Labor Statistics")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0))
print(g)
ani.pause()
print(i)  #counter
}
},movie.name="cpi_dance_lolly_11_21_2016.gif",ani.width = 650, ani.height = 450)
rm(counties)
rm(cmap)
rm(cmap.all)
rm(shareDF)
rm(popDF)
rm(popDF.i)
rm(shareDF.i)
rm(smap)
rm(smap.all)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
head(dt)
rm(dt)
rm(states)
rm(mycaption)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
