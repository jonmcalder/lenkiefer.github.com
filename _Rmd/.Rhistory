labs(title="Rank for state + D.C. annual house price growth (1 to 51)",x="",y="",
subtitle=paste0(yy,"M",mm),
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
ggplot(data=statedata[year==yy & month==mm,],aes(x=hparank,y=state,color=hparank))+
#geom_point(size=3)+
scale_color_viridis(name = "", discrete=F,option="D",end=0.95,direction=-1)+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y=element_blank())+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.line.x=element_blank())+
geom_text(aes(label=paste0(state,":",hparank) ))+
theme(legend.position="none")+
labs(title="Rank for state + D.C. annual house price growth (1 to 51)",x="",y="",
subtitle=paste0(yy,"M",mm),
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
ggplot(data=statedata[year==yy & month==mm,],aes(x=hparank,y=state,color=hparank))+
#geom_point(size=3)+
scale_color_viridis(name = "", discrete=F,option="D",end=0.9,direction=-1)+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y=element_blank())+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.line.x=element_blank())+
geom_text(aes(label=paste0(state,":",hparank) ))+
theme(legend.position="none")+
labs(title="Rank for state + D.C. annual house price growth (1 to 51)",x="",y="",
subtitle=paste0(yy,"M",mm),
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
ggplot(data=statedata[year==yy & month==mm,],aes(x=hparank,y=state,color=hparank))+
#geom_point(size=3)+
scale_color_viridis(name = "", discrete=F,option="D",end=0.9,direction=-1)+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y=element_blank())+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.line.x=element_blank())+
geom_text(aes(label=paste0(state,":",hparank) ))+
theme(legend.position="none")+
labs(title="Rank for state + D.C. annual house price growth (1 to 51)",x="",y="",
subtitle=paste0(yy,"M",mm),
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
seq(9,12,12)
oopt = ani.options(interval = 0.2)
saveGIF({for (yy in 2005:2016) for(mm in seq(9,12,12)) {  {
if (yy==2016 & mm>9) {mm<-9}
g<-
ggplot(data=statedata[year==yy & month==mm,],aes(x=hparank,y=state,color=hparank))+
#geom_point(size=3)+
scale_color_viridis(name = "", discrete=F,option="D",end=0.9,direction=-1)+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y=element_blank())+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.line.x=element_blank())+
geom_text(aes(label=paste0(state,":",hparank) ))+
theme(legend.position="none")+
labs(title="Rank for state + D.C. annual house price growth (1 to 51)",x="",y="",
subtitle=paste0(yy,"M",mm),
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
print(g)
print(yy)
print(mm)
ani.pause()
}
}
for (i2 in 1:2) {print(g)
ani.pause()  }
},movie.name="fmhpi map 2016q3 v2.gif",ani.width = 550, ani.height = 550)
oopt = ani.options(interval = 0.3)
saveGIF({for (yy in 2005:2016) for(mm in seq(9,12,12)) {  {
if (yy==2016 & mm>9) {mm<-9}
g<-
ggplot(data=statedata[year==yy & month==mm,],aes(x=hparank,y=state,color=hparank))+
#geom_point(size=3)+
scale_color_viridis(name = "", discrete=F,option="D",end=0.9,direction=-1)+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y=element_blank())+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.line.x=element_blank())+
geom_text(aes(label=paste0(state,":",hparank) ))+
theme(legend.position="none")+
labs(title="Rank for state + D.C. annual house price growth (1 to 51)",x="",y="",
subtitle=paste0(yy,"M",mm),
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
print(g)
print(yy)
print(mm)
ani.pause()
}
}
for (i2 in 1:2) {print(g)
ani.pause()  }
},movie.name="fmhpi map 2016q3 v3.gif",ani.width = 550, ani.height = 550)
oopt = ani.options(interval = 0.2)
saveGIF({for (yy in 2005:2016) for(mm in seq(1,12,1)) {  {
if (yy==2016 & mm>9) {mm<-9}
g<-
ggplot() +
geom_map(data = smap, map = smap,
aes(x = long, y = lat, map_id = id),
color = "#2b2b2b", size = 0.05, fill = NA) +
geom_map(data =subset(states@data,year==yy & month==mm), map = smap,
aes( map_id = fips_state,fill=hparank),
color = "gray", size = .25) +
theme_map( base_size = 12) + #facet_wrap(~mylabel,ncol=3)+
theme(plot.title=element_text( size = 16, margin=margin(b=10))) +
theme(plot.subtitle=element_text(size = 14, margin=margin(b=-20))) +
theme(plot.caption=element_text(size = 9, margin=margin(t=-15))) +
coord_proj(us_laea_proj) +   labs(title="",subtitle="" ) +
scale_fill_viridis(name = "", discrete=F,option="D",end=0.95,
direction=-1
#limits=c(-0.25,0.25),
#label=percent
)+
theme(legend.position = "top") +theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
labs(title="Rank for state + D.C. annual house price growth (1 to 51)",
subtitle=paste0(yy,"M",mm),
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
print(g)
print(yy)
print(mm)
ani.pause()
}
}
for (i2 in 1:2) {print(g)
ani.pause()  }
},movie.name="fmhpi map 2016q3 v2.gif",ani.width = 550, ani.height = 350)
oopt = ani.options(interval = 0.2)
saveGIF({for (yy in 1980:2016) for(mm in seq(9,12,12)) {  {
if (yy==2016 & mm>9) {mm<-9}
g<-
ggplot() +
geom_map(data = smap, map = smap,
aes(x = long, y = lat, map_id = id),
color = "#2b2b2b", size = 0.05, fill = NA) +
geom_map(data =subset(states@data,year==yy & month==mm), map = smap,
aes( map_id = fips_state,fill=hparank),
color = "gray", size = .25) +
theme_map( base_size = 12) + #facet_wrap(~mylabel,ncol=3)+
theme(plot.title=element_text( size = 16, margin=margin(b=10))) +
theme(plot.subtitle=element_text(size = 14, margin=margin(b=-20))) +
theme(plot.caption=element_text(size = 9, margin=margin(t=-15))) +
coord_proj(us_laea_proj) +   labs(title="",subtitle="" ) +
scale_fill_viridis(name = "", discrete=F,option="D",end=0.95,
direction=-1
#limits=c(-0.25,0.25),
#label=percent
)+
theme(legend.position = "top") +theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
labs(title="Rank for state + D.C. annual house price growth (1 to 51)",
subtitle=paste0(yy,"M",mm),
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
print(g)
print(yy)
print(mm)
ani.pause()
}
}
for (i2 in 1:4) {print(g)
ani.pause()  }
},movie.name="fmhpi map 2016q3 v4.gif",ani.width = 550, ani.height = 350)
oopt = ani.options(interval = 0.5)
saveGIF({for (yy in 1980:2016) for(mm in seq(9,12,12)) {  {
if (yy==2016 & mm>9) {mm<-9}
g<-
ggplot() +
geom_map(data = smap, map = smap,
aes(x = long, y = lat, map_id = id),
color = "#2b2b2b", size = 0.05, fill = NA) +
geom_map(data =subset(states@data,year==yy & month==mm), map = smap,
aes( map_id = fips_state,fill=hparank),
color = "gray", size = .25) +
theme_map( base_size = 12) + #facet_wrap(~mylabel,ncol=3)+
theme(plot.title=element_text( size = 16, margin=margin(b=10))) +
theme(plot.subtitle=element_text(size = 14, margin=margin(b=-20))) +
theme(plot.caption=element_text(size = 9, margin=margin(t=-15))) +
coord_proj(us_laea_proj) +   labs(title="",subtitle="" ) +
scale_fill_viridis(name = "", discrete=F,option="D",end=0.95,
direction=-1
#limits=c(-0.25,0.25),
#label=percent
)+
theme(legend.position = "top") +theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
labs(title="Rank for state + D.C. annual house price growth (1 to 51)",
subtitle=paste0(yy,"M",mm),
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
print(g)
print(yy)
print(mm)
ani.pause()
}
}
for (i2 in 1:4) {print(g)
ani.pause()  }
},movie.name="fmhpi map 2016q3 v4.gif",ani.width = 550, ani.height = 350)
statedata[year==2016 & month==9]
statedata[year==2016 & month==9 & order(hpa.comp)]
statedata[year==2016 & month==9 , order(hpa.comp)]
statedata[year==2016 & month==9 ][order(hpi.comp)]
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
ggplot() +
geom_map(data = smap, map = smap,
aes(x = long, y = lat, map_id = id),
color = "#2b2b2b", size = 0.05, fill = NA) +
geom_map(data =subset(states@data,year==2016 & month==9), map = smap,
aes( map_id = fips_state,fill=hpi.compd),
color = "gray", size = .25) +
theme_map( base_size = 12) + #facet_wrap(~mylabel,ncol=3)+
theme(plot.title=element_text( size = 16, margin=margin(b=10))) +
theme(plot.subtitle=element_text(size = 14, margin=margin(b=-20))) +
theme(plot.caption=element_text(size = 9, margin=margin(t=-15))) +
coord_proj(us_laea_proj) +   labs(title="",subtitle="" ) +
scale_fill_viridis(name = "", discrete=T,option="D",end=0.95, labels=unique(statedata$hpi.compd)
#end=0.95,
#direction=-1,limits=c(-0.45,0.45),
#label=percent
)+
theme(legend.position = "top") +theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
labs(title="House Prices in September 2016 relative to pre-2008 peak",
#subtitle="Percentage difference from pre-2008 peak",
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
unique(statedata$hpi.compd)
test<-statedata[year==2016 & month==9 ][order(hpi.comp)]
test
unique(test$hpi.compd)
ggplot() +
geom_map(data = smap, map = smap,
aes(x = long, y = lat, map_id = id),
color = "#2b2b2b", size = 0.05, fill = NA) +
geom_map(data =subset(states@data,year==2016 & month==9), map = smap,
aes( map_id = fips_state,fill=hpi.compd),
color = "gray", size = .25) +
theme_map( base_size = 12) + #facet_wrap(~mylabel,ncol=3)+
theme(plot.title=element_text( size = 16, margin=margin(b=10))) +
theme(plot.subtitle=element_text(size = 14, margin=margin(b=-20))) +
theme(plot.caption=element_text(size = 9, margin=margin(t=-15))) +
coord_proj(us_laea_proj) +   labs(title="",subtitle="" ) +
scale_fill_viridis(name = "", discrete=T,option="D",end=0.95
#end=0.95,
#direction=-1,limits=c(-0.45,0.45),
#label=percent
)+
theme(legend.position = "top") +theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
labs(title="House Prices in September 2016 relative to pre-2008 peak",
#subtitle="Percentage difference from pre-2008 peak",
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
ggplot(data=statedata[(year==yy) & month==mm & state !="DC" & state !="US.NSA"], aes(x=hpi, y=state, label=state,color=hpa12))+
geom_text(nudge_x = 0.025)  +
geom_point()+scale_x_log10(limits=c(70,350), breaks=c(70,100,150,250,350))+
geom_segment(aes(xend=hpi12min,x=hpi12max,y=state,yend=state),alpha=0.7)+
theme_minimal()  +
#scale_colour_gradient2(low="red",mid="gray", high="blue")+
#scale_colour_gradient2(low="red",mid="#00B0F0",high="blue",limits=c(-.7,.7),name = "12-month HPA",labels = percent)+
scale_colour_gradient(low="red",high="blue",name = "12-month HPA",labels = percent)+
labs(y="State", x="House price index (log scale, Dec 2000 =100, NSA)",
title="State house price dynamics",
subtitle=paste(as.character(statedata[year==yy & month==mm & state=="US.SA"]$date,format="%b-%Y")),
caption="@lenkiefer Source: Freddie Mac house price index, each dot a state, lines trailing 12-month min-max")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
#theme(legend.position="bottom")
theme(legend.justification=c(0,0), legend.position=c(.8,.75))
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
ggplot(data=statedata[(year==yy) & month==mm & state !="DC" & state !="US.NSA"], aes(x=hpi, y=state, label=state,color=hpa12))+
geom_text(nudge_x = 0.025)  +
geom_point()+scale_x_log10(limits=c(70,350), breaks=c(70,100,150,250,350))+
geom_segment(aes(xend=hpi12min,x=hpi12max,y=state,yend=state),alpha=0.7)+
theme_minimal()  +
#scale_colour_gradient2(low="red",mid="gray", high="blue")+
#scale_colour_gradient2(low="red",mid="#00B0F0",high="blue",limits=c(-.7,.7),name = "12-month HPA",labels = percent)+
scale_colour_gradient(low="red",high="blue",name = "12-month HPA",labels = percent)+
labs(y="State", x="House price index (log scale, Dec 2000 =100, NSA)",
title="State house price dynamics",
subtitle=paste(as.character(statedata[year==yy & month==mm & state=="CA"]$date,format="%b-%Y")),
caption="@lenkiefer Source: Freddie Mac house price index, each dot a state, lines trailing 12-month min-max")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
#theme(legend.position="bottom")
theme(legend.justification=c(0,0), legend.position=c(.8,.75))
ggplot(data=statedata[(year==yy) & month==mm & state !="DC" & state !="US.NSA"], aes(x=hpi, y=reorder(state,-hpi), label=state,color=hpa12))+
geom_text(nudge_x = 0.025)  +
geom_point()+scale_x_log10(limits=c(70,350), breaks=c(70,100,150,250,350))+
geom_segment(aes(xend=hpi12min,x=hpi12max,y=state,yend=state),alpha=0.7)+
theme_minimal()  +
#scale_colour_gradient2(low="red",mid="gray", high="blue")+
#scale_colour_gradient2(low="red",mid="#00B0F0",high="blue",limits=c(-.7,.7),name = "12-month HPA",labels = percent)+
scale_colour_gradient(low="red",high="blue",name = "12-month HPA",labels = percent)+
labs(y="State", x="House price index (log scale, Dec 2000 =100, NSA)",
title="State house price dynamics",
subtitle=paste(as.character(statedata[year==yy & month==mm & state=="CA"]$date,format="%b-%Y")),
caption="@lenkiefer Source: Freddie Mac house price index, each dot a state, lines trailing 12-month min-max")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
#theme(legend.position="bottom")
theme(legend.justification=c(0,0), legend.position=c(.8,.75))
ggplot(data=statedata[(year==yy) & month==mm & state !="DC" & state !="US.NSA"], aes(x=hpi, y=reorder(state,-hpi), label=state,color=hpa12))+
geom_text(nudge_x = 0.025)  +
geom_point()+scale_x_log10(limits=c(70,350), breaks=c(70,100,150,250,350))+
geom_segment(aes(xend=hpi12min,x=hpi12max,y=state,yend=state),alpha=0.7)+
theme_minimal()  +
scale_colour_gradient(low="red",high="blue",name = "12-month HPA",labels = percent)+
labs(y="State", x="House price index (log scale, Dec 2000 =100, NSA)",
title="State house price dynamics",
subtitle=paste(as.character(statedata[year==yy & month==mm & state=="CA"]$date,format="%b-%Y")),
caption="@lenkiefer Source: Freddie Mac house price index, each dot a state, lines trailing 12-month min-max")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y=element_blank())+
theme(legend.justification=c(0,0), legend.position=c(.8,.75))
ggplot(data=statedata[(year==yy) & month==mm & state !="DC" & state !="US.NSA"], aes(x=hpi, y=reorder(state,-hpi), label=state,color=hpa12))+
geom_text(nudge_x = 0.025)  +
geom_point()+scale_x_log10(limits=c(70,350), breaks=c(70,100,150,250,350))+
geom_segment(aes(xend=hpi12min,x=hpi12max,y=state,yend=state),alpha=0.7)+
theme_minimal()  +
scale_colour_gradient(low="red",high="blue",name = "12-month HPA",labels = percent)+
labs(y="", x="House price index (log scale, Dec 2000 =100, NSA)",
title="State house price dynamics",
subtitle=paste(as.character(statedata[year==yy & month==mm & state=="CA"]$date,format="%b-%Y")),
caption="@lenkiefer Source: Freddie Mac house price index, each dot a state, lines trailing 12-month min-max")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y=element_blank())+
theme(legend.justification=c(0,0), legend.position=c(.8,.75))
ggplot(data=statedata[(year==yy) & month==mm & state !="DC" & state !="US.NSA"], aes(x=hpi, y=reorder(state,-hpi), label=state,color=hpa12))+
geom_text(nudge_x = 0.025)  +
geom_point()+scale_x_log10(limits=c(70,350), breaks=c(70,100,150,250,350))+
geom_segment(aes(xend=hpi12min,x=hpi12max,y=state,yend=state),alpha=0.7)+
theme_minimal()  +
scale_colour_gradient(low="red",high="blue",name = "12-month HPA",labels = percent)+
labs(y="", x="House price index (log scale, Dec 2000 =100, NSA)",
title="State house price dynamics",
subtitle=paste(as.character(statedata[year==yy & month==mm & state=="CA"]$date,format="%b-%Y")),
caption="@lenkiefer Source: Freddie Mac house price index, each dot a state, lines trailing 12-month min-max")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y=element_blank(),
panel.grid.x=element_blank())+
theme(legend.justification=c(0,0), legend.position=c(.8,.75))
ggplot(data=statedata[(year==yy) & month==mm & state !="DC" & state !="US.NSA"], aes(x=hpi, y=reorder(state,-hpi), label=state,color=hpa12))+
geom_text(nudge_x = 0.025)  +
geom_point()+scale_x_log10(limits=c(70,350), breaks=c(70,100,150,250,350))+
geom_segment(aes(xend=hpi12min,x=hpi12max,y=state,yend=state),alpha=0.7)+
theme_minimal()  +
scale_colour_gradient(low="red",high="blue",name = "12-month HPA",labels = percent)+
labs(y="", x="House price index (log scale, Dec 2000 =100, NSA)",
title="State house price dynamics",
subtitle=paste(as.character(statedata[year==yy & month==mm & state=="CA"]$date,format="%b-%Y")),
caption="@lenkiefer Source: Freddie Mac house price index, each dot a state, lines trailing 12-month min-max")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y=element_blank(),
panel.grid.major.x=element_blank())+
theme(legend.justification=c(0,0), legend.position=c(.8,.75))
ggplot(data=statedata[(year==yy) & month==mm & state !="DC" & state !="US.NSA"], aes(x=hpi, y=reorder(state,-hpi), label=state,color=hpa12))+
geom_text(nudge_x = 0.025)  +
geom_point()+scale_x_log10(limits=c(70,350), breaks=c(70,100,150,250,350))+
geom_segment(aes(xend=hpi12min,x=hpi12max,y=state,yend=state),alpha=0.7)+
theme_minimal()  +
scale_colour_gradient(low="red",high="blue",name = "12-month HPA",labels = percent)+
labs(y="", x="House price index (log scale, Dec 2000 =100, NSA)",
title="State house price dynamics",
subtitle=paste(as.character(statedata[year==yy & month==mm & state=="CA"]$date,format="%b-%Y")),
caption="@lenkiefer Source: Freddie Mac house price index, each dot a state, lines trailing 12-month min-max")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y=element_blank(),
panel.grid.major.y=element_blank())+
theme(legend.justification=c(0,0), legend.position=c(.8,.75))
ggplot(data=statedata[(year==yy) & month==mm & state !="DC" & state !="US.NSA"], aes(x=hpi, y=reorder(state,-hpi), label=state,color=hpa12))+
geom_text(nudge_x = 0.025)  +
geom_point()+scale_x_log10(limits=c(70,350), breaks=c(70,100,150,250,350))+
geom_segment(aes(xend=hpi12min,x=hpi12max,y=state,yend=state),alpha=0.7)+
theme_minimal()  +
scale_colour_gradient(low="red",high="blue",name = "12-month HPA",labels = percent)+
labs(y="", x="House price index (log scale, Dec 2000 =100, NSA)",
title="State house price dynamics",
subtitle=paste(as.character(statedata[year==yy & month==mm & state=="CA"]$date,format="%b-%Y")),
caption="@lenkiefer Source: Freddie Mac house price index, each dot a state, lines trailing 12-month min-max")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(size=6,hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y=element_blank(),
panel.grid.major.y=element_blank())+
theme(legend.justification=c(0,0), legend.position=c(.8,.75))
ggplot(data=statedata[(year==yy) & month==mm & state !="DC" & state !="US.NSA"], aes(x=hpi, y=reorder(state,-hpi), label=state,color=hpa12))+
geom_text(nudge_x = 0.025)  +
geom_point()+scale_x_log10(limits=c(70,350), breaks=c(70,100,150,250,350))+
geom_segment(aes(xend=hpi12min,x=hpi12max,y=state,yend=state),alpha=0.7)+
theme_minimal()  +
scale_colour_gradient(low="red",high="blue",name = "12-month HPA",labels = percent)+
labs(y="", x="House price index (log scale, Dec 2000 =100, NSA)",
title="State house price dynamics",
subtitle=paste(as.character(statedata[year==yy & month==mm & state=="CA"]$date,format="%b-%Y")),
caption="@lenkiefer Source: Freddie Mac house price index, each dot a state, lines trailing 12-month min-max")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(size=8,hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank(),
axis.line.y=element_blank(),
panel.grid.major.y=element_blank())+
theme(legend.justification=c(0,0), legend.position=c(.8,.75))
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
statedata[year==2016 & month==9][order(hpi)]
statedata[year==2016 & month==9][order(-hpa12)]
statedata[year==2016 & month==9][order(hpa12)]
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
ggplot() +
geom_map(data = smap, map = smap,
aes(x = long, y = lat, map_id = id),
color = "#2b2b2b", size = 0.05, fill = NA) +
geom_map(data =subset(states@data,year==yy & month==mm), map = smap,
aes( map_id = fips_state,fill=hparank),
color = "gray", size = .25) +
theme_map( base_size = 12) + #facet_wrap(~mylabel,ncol=3)+
theme(plot.title=element_text( size = 16, margin=margin(b=10))) +
theme(plot.subtitle=element_text(size = 14, margin=margin(b=-20))) +
theme(plot.caption=element_text(size = 9, margin=margin(t=-15))) +
coord_proj(us_laea_proj) +   labs(title="",subtitle="" ) +
scale_fill_viridis(name = "", discrete=F,option="D",end=0.95,
direction=-1
#limits=c(-0.25,0.25),
#label=percent
)+
theme(legend.position = "top") +theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
labs(title="Rank for state + D.C. annual house price growth (1 to 51)",
subtitle=paste0(yy,"M",mm),
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
ggplot() +
geom_map(data = smap, map = smap,
aes(x = long, y = lat, map_id = id),
color = "#2b2b2b", size = 0.05, fill = NA) +
geom_map(data =subset(states@data,year>2007 & month==mm), map = smap,
aes( map_id = fips_state,fill=hparank),
color = "gray", size = .25) +
theme_map( base_size = 12) + facet_wrap(~year,ncol=3)+
theme(plot.title=element_text( size = 16, margin=margin(b=10))) +
theme(plot.subtitle=element_text(size = 14, margin=margin(b=-20))) +
theme(plot.caption=element_text(size = 9, margin=margin(t=-15))) +
coord_proj(us_laea_proj) +   labs(title="",subtitle="" ) +
scale_fill_viridis(name = "", discrete=F,option="D",end=0.95,
direction=-1
#limits=c(-0.25,0.25),
#label=percent
)+
theme(legend.position = "top") +theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
labs(title="Rank for state + D.C. annual house price growth (1 to 51)",
subtitle=paste0(yy,"M",mm),
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
ggplot() +
geom_map(data = smap, map = smap,
aes(x = long, y = lat, map_id = id),
color = "#2b2b2b", size = 0.05, fill = NA) +
geom_map(data =subset(states@data,year>2015 & month==mm), map = smap,
aes( map_id = fips_state,fill=hparank),
color = "gray", size = .25) +
theme_map( base_size = 12) + #facet_wrap(~year,ncol=3)+
theme(plot.title=element_text( size = 16, margin=margin(b=10))) +
theme(plot.subtitle=element_text(size = 14, margin=margin(b=-20))) +
theme(plot.caption=element_text(size = 9, margin=margin(t=-15))) +
coord_proj(us_laea_proj) +   labs(title="",subtitle="" ) +
scale_fill_viridis(name = "", discrete=F,option="D",end=0.95,
direction=-1
#limits=c(-0.25,0.25),
#label=percent
)+
theme(legend.position = "top") +theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
labs(title="Rank for state + D.C. annual house price growth (1 to 51)",
subtitle="September of 2016",
caption="@lenkiefer Source: Freddie Mac House Price Index (Not Seasonally adjusted)")
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
rm(data.ease)
rm(data.noease)
rm(data.us)
rm(cmap.all)
rm(cmap)
rm(dt)
rm(list=(ls)())
