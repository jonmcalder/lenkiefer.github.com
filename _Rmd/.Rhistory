geom_segment(aes(xend=63,x=value,yend=reorder(state,-value)))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>63,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate in 2015",
subtitle="U.S. 63%",
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=ho.dat[! (state %in% c("United States","District of Columbia")) & year==2015,],aes(y=reorder(state,-value),x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=63,color="gray",linetype=2)+
theme_minimal()+
annotate(geom="text",x=63,y=50,label="U.S.:63%",hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=63,x=value,yend=reorder(state,-value)))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>63,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate in 2015",
subtitle="U.S. 63%",
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=ho.dat[! (state %in% c("United States","District of Columbia")) & year==2015,],aes(y=reorder(state,-value),x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=63,color="gray",linetype=2)+
theme_minimal()+
annotate(geom="text",x=63,y=50,label=" U.S.:63%",hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=63,x=value,yend=reorder(state,-value)))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>63,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate in 2015",
subtitle="",
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
y.list<-unique(ho.dat$year)
myf2<-function(y){as.data.frame(ho.dat[year==y, list(year,st,value)])}
# use lapply to generate the list of data sets:
my.list2<-lapply(c(2015,y.list),myf2)
tf <- tween_states(my.list2, tweenlength= 2, statelength=3, ease=rep('cubic-in-out',24),
nframes=100)
tf
ho.dat$yf<-factor(ho.dat$year)
ho.dat
myf2<-function(y){as.data.frame(ho.dat[year==y, list(yf,st,value)])}
# use lapply to generate the list of data sets:
my.list2<-lapply(c(2015,y.list),myf2)
tf <- tween_states(my.list2, tweenlength= 2, statelength=3, ease=rep('cubic-in-out',24),
nframes=100)
tf
tf<-data.table(tf)
tf
us.v<-unique(tf[.frame==i & st=="United States"]$value)
us.v
i
i<-117
us.v<-unique(tf[.frame==i & st=="United States"]$value)
us.v
ggplot(data=tf[.frame==i,],aes(y=reorder(state,-value),x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=63,color="gray",linetype=2)+
theme_minimal()+
annotate(geom="text",x=us.v,y=50,label=paste(" U.S.:",us.v,"%",hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=reorder(state,-value)))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>63,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate in 2015",
subtitle="",
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
)
ggplot(data=tf[.frame==i,],aes(y=reorder(state,-value),x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=63,color="gray",linetype=2)+
theme_minimal()+
annotate(geom="text",x=us.v,y=50,label=paste(" U.S.:",us.v,"%",hjust=0)
)
ggplot(data=tf[.frame==i,],aes(y=reorder(state,-value),x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=63,color="gray",linetype=2)+
theme_minimal()+
annotate(geom="text",x=us.v,y=50,label=paste(" U.S.:",us.v,"%"),hjust=0)
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=63,color="gray",linetype=2)+
theme_minimal()+
annotate(geom="text",x=us.v,y=50,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=reorder(state,-value)))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>63,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate in 2015",
subtitle="",
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=63,color="gray",linetype=2)+
theme_minimal()+
annotate(geom="text",x=us.v,y=50,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>63,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate in 2015",
subtitle="",
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
i
us.v
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
annotate(geom="text",x=us.v,y=50,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>63,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate in 2015",
subtitle="",
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
annotate(geom="text",x=us.v,y=50,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate in 2015",
subtitle="",
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
annotate(geom="text",x=us.v,y=50,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate",
subtitle=unique(tf[.frame==i,]$yf),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate",
subtitle=unique(tf[.frame==i,]$yf),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_rug(data=tf[.frame==i & st="United States",],sides="b")+
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate",
subtitle=unique(tf[.frame==i,]$yf),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
tf[.frame==i & st="United States",]
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_rug(data=tf[.frame==i & st=="United States",],sides="b")+
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate",
subtitle=unique(tf[.frame==i,]$yf),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_rug(data=tf[.frame==i & st=="United States",],sides="tb")+
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate",
subtitle=unique(tf[.frame==i,]$yf),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
?geom_rug
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_rug(data=tf[.frame==i & st=="United States",])+
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(50,75),breaks=seq(50,75,5))+
labs(x="",y="",title="Homeownership rate",
subtitle=unique(tf[.frame==i,]$yf),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
summary(tf)
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_rug(data=tf[.frame==i & st=="United States",])+
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(20,80),breaks=seq(20,80,10))+
labs(x="",y="",title="Homeownership rate",
subtitle=unique(tf[.frame==i,]$yf),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_rug(data=tf[.frame==i & st=="United States",])+
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(20,80),breaks=seq(20,80,10))+
labs(x="",y="",title="Homeownership rate",
subtitle=paste0("U.S. rate ",us.v," in ",unique(tf[.frame==i,]$yf)),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_rug(data=tf[.frame==i & st=="United States",])+
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(20,80),breaks=seq(20,80,10))+
labs(x="",y="",title="Homeownership rate",
subtitle=paste0("U.S. rate ",us.v,"% in ",unique(tf[.frame==i,]$yf)),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=tf[.frame==i,],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_rug(data=tf[.frame==i & st=="United States",])+
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(20,80),breaks=seq(20,80,10))+
labs(x="",y="",title="Homeownership rate",
subtitle=paste0("U.S. rate ",us.v,"% in ",unique(tf[.frame==i,]$yf)),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=tf[.frame==i & ! (st %in% c("United States","District of Columbia")),],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_rug(data=tf[.frame==i & st=="United States",])+
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(20,80),breaks=seq(20,80,10))+
labs(x="",y="",title="Homeownership rate",
subtitle=paste0("U.S. rate ",us.v,"% in ",unique(tf[.frame==i,]$yf)),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=tf[.frame==i & !(st %in% c("United States","District of Columbia")),],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+
geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(20,80),breaks=seq(20,80,10))+
labs(x="",y="",title="Homeownership rate",
subtitle=paste0("U.S. rate ",us.v,"% in ",unique(tf[.frame==i,]$yf)),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
summary(tf[ !(st %in% c("United States","District of Columbia")),])
ggplot(data=tf[.frame==i & !(st %in% c("United States","District of Columbia")),],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+
geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(25,80),breaks=seq(30,80,10))+
labs(x="",y="",title="Homeownership rate",
subtitle=paste0("U.S. rate ",us.v,"% in ",unique(tf[.frame==i,]$yf)),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
getwd(0)
getwd()
setwd('C:/Users/Leonard/Documents/Data Viz/blog/hvs')
tf
oopt = ani.options(interval = 0.1)
saveGIF({for (i in 1:max(tf$.frame)) {
us.v<-unique(tf[.frame==i & st=="United States"]$value)
g<-
ggplot(data=tf[.frame==i & !(st %in% c("United States","District of Columbia")),],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+
geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(25,80),breaks=seq(30,80,10))+
labs(x="",y="",title="Homeownership rate",
subtitle=paste0("U.S. rate ",us.v,"% in ",unique(tf[.frame==i,]$yf)),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
print(g)
ani.pause()
print(i)
}
},movie.name="ho rate by state viz 2.gif",ani.width = 650, ani.height = 450)
unique(ho.dat$year)
my.list2<-lapply(c(2015,seq(1900,2000,10),2005,2010,2015),myf2)
tf <- tween_states(my.list2, tweenlength= 2, statelength=3, ease=rep('cubic-in-out',24),
nframes=200)
tf<-data.table(tf)
tf
oopt = ani.options(interval = 0.1)
saveGIF({for (i in 1:max(tf$.frame)) {
us.v<-unique(tf[.frame==i & st=="United States"]$value)
g<-
ggplot(data=tf[.frame==i & !(st %in% c("United States","District of Columbia")),],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+
geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(25,80),breaks=seq(30,80,10))+
labs(x="",y="",title="Homeownership rate",
subtitle=paste0("U.S. ",us.v,"% in ",unique(tf[.frame==i,]$yf)),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
print(g)
ani.pause()
print(i)
}
},movie.name="ho rate by state viz 2.gif",ani.width = 650, ani.height = 450)
ggplot(data=tf[.frame==i & !(st %in% c("United States","District of Columbia")),],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+
geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(25,80),breaks=seq(30,80,10))+
labs(x="",y="",title="Homeownership rate",
subtitle=paste0("U.S. ",round(us.v,0),"% in ",unique(tf[.frame==i,]$yf)),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
ggplot(data=tf[.frame==i & !(st %in% c("United States","District of Columbia")),],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+
geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(25,80),breaks=seq(30,80,10))+
labs(x="",y="",title="Homeownership rate",
subtitle=paste0("U.S.: ",round(us.v,0),"% in ",unique(tf[.frame==i,]$yf)),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
oopt = ani.options(interval = 0.1)
saveGIF({for (i in 1:max(tf$.frame)) {
us.v<-unique(tf[.frame==i & st=="United States"]$value)
g<-
ggplot(data=tf[.frame==i & !(st %in% c("United States","District of Columbia")),],aes(y=st,x=value,color=value))+
scale_color_viridis(direction=-1,end=0.9)+
geom_point(size=3)+
geom_vline(xintercept=us.v,color="gray",linetype=2)+
theme_minimal()+
#annotate(geom="text",x=us.v,y=0,label=paste(" U.S.:",us.v,"%"),hjust=0)+
theme(legend.position="none")+ #suppress color legend
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+  #remove gridlines
geom_segment(aes(xend=us.v,x=value,yend=st))+  #add segment from U.S. average
geom_text(aes(label=paste(" ",round(value,1)," "),hjust=ifelse(value>us.v,0,1)),color=viridis(5)[2],size=4)+
scale_x_continuous(limits=c(25,80),breaks=seq(30,80,10))+
labs(x="",y="",title="Homeownership rate",
subtitle=paste0("U.S. ",round(us.v,0),"% in ",unique(tf[.frame==i,]$yf)),
caption="@lenkiefer Source: U.S. Census Bureau\n1900-2010 Decennial Census, 2005 & 2015 American Community Survey 1-year estimates")+
theme(plot.caption=element_text(hjust=0))+
theme(axis.text=element_text(size=7))
print(g)
ani.pause()
print(i)
}
},movie.name="ho rate by state viz 2.gif",ani.width = 650, ani.height = 650)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
ho.dat[value>70 & year==2015]
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
rm(smap)
rm(smap.all)
rm(shareDF.i)
rm(shareDF)
rm(cmap)
rm(cmap.al)
rm(cmap.all)
rm(bdata)
rm(cpi.item)
rm(cpi.series)
rm(cpi1)
rm(cpi)
rm(cpi2)
rm(cpi3)
rm(cpi4)
rm(cpi4n)
rm(cpi5)
rm(cpi5n)
rm(cpi6)
rm(cpi6n)
rm(dt)
rm(g2)
rm(popDF)
rm(popDF.i)
rm(pd)
rm(pmms30yr)
rm(udata)
rm(counties)
rm(path)
