geom_col(alpha=0,data=pmms30yr[year>2000],color=NA)+
geom_col()+
scale_fill_viridis(name="52-week\nChange (pp)",discrete=F,option="B")+
scale_color_viridis(name="52-week\nChange (pp)",discrete=F,option="B")+
theme_minimal()+
theme(axis.text.x=element_text(size=6))+
labs(x="", y="",
title="52-week change in 30-year Fixed Mortgage Rate",
#subtitle="52-week change in mortgage rates",
caption="@lenkiefer Source: Freddie Mac Primary Mortgage Market Survey")+
scale_x_date(date_breaks="1 year",date_label="%Y")+
theme(plot.title=element_text(size=14))+
theme(axis.text=element_text(size=8))+
theme(plot.caption=element_text(hjust=0), legend.position="none")
return(g.diff)
}
diff.plot(2004)
multiplot(diff.plot(2004)+labs(caption=""),tile.plot(2004)+theme(legend.position="none"))
getwd()
getwd()
setwd('C:/Users/Leonard/Documents/Data Viz/blog/pmms')
oopt = ani.options(interval = 0.15)
saveGIF({for (i in seq(2001,2016,1)) {
g<-multiplot(diff.plot(y)+labs(caption=""),tile.plot(y)+theme(legend.position="none"))
print(g)
print(dlist[i])
ani.pause()
}
for (i2 in 1:10) {
g<-multiplot(diff.plot(y)+labs(caption=""),tile.plot(y)+theme(legend.position="none"))
print(g)
ani.pause()
}
},movie.name="tile_rates_12_18_2016.gif",ani.width = 650, ani.height = 1000)
```
oopt = ani.options(interval = 0.15)
saveGIF({for (y in seq(2001,2016,1)) {
g<-multiplot(diff.plot(y)+labs(caption=""),tile.plot(y)+theme(legend.position="none"))
print(g)
print(dlist[i])
ani.pause()
}
for (i2 in 1:10) {
g<-multiplot(diff.plot(y)+labs(caption=""),tile.plot(y)+theme(legend.position="none"))
print(g)
ani.pause()
}
},movie.name="tile_rates_12_18_2016.gif",ani.width = 650, ani.height = 1000)
oopt = ani.options(interval = 0.15)
saveGIF({for (y in seq(2001,2016,1)) {
g<-multiplot(diff.plot(y)+labs(caption=""),tile.plot(y)+theme(legend.position="none"))
print(g)
print(y)
ani.pause()
}
for (i2 in 1:10) {
g<-multiplot(diff.plot(y)+labs(caption=""),tile.plot(y)+theme(legend.position="none"))
print(g)
ani.pause()
}
},movie.name="tile_rates_12_18_2016.gif",ani.width = 650, ani.height = 1000)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
multiplot(diff.plot(y)+labs(caption=""),tile.plot(y)+theme(legend.position="none"),
,layout=matrix(c(1,2,2), nrow=3, byrow=TRUE))
multiplot(diff.plot(y)+labs(caption=""),tile.plot(y)+theme(legend.position="none"),
layout=matrix(c(1,2,2), nrow=3, byrow=TRUE))
setwd('C:/Users/Leonard/Documents/Data Viz/blog/pmms')
oopt = ani.options(interval = 0.15)
saveGIF({for (i in seq(2001,2016,1)) {
g<-multiplot(diff.plot(y)+labs(caption=""),tile.plot(y)+theme(legend.position="none"),
layout=matrix(c(1,2,2), nrow=3, byrow=TRUE))
print(g)
print(dlist[i])
ani.pause()
}
for (i2 in 1:10) {
g<-  multiplot(g.line,g.tile,layout=matrix(c(1,2,2), nrow=3, byrow=TRUE))
print(g)
ani.pause()
}
},movie.name="tile_rates_12_18_2016.gif",ani.width = 650, ani.height = 800)
oopt = ani.options(interval = 0.15)
saveGIF({for (i in seq(2001,2016,1)) {
g<-multiplot(diff.plot(y)+labs(caption=""),tile.plot(y)+theme(legend.position="none"),
layout=matrix(c(1,2,2), nrow=3, byrow=TRUE))
print(g)
print(y)
ani.pause()
}
for (i2 in 1:10) {
g<-  multiplot(g.line,g.tile,layout=matrix(c(1,2,2), nrow=3, byrow=TRUE))
print(g)
ani.pause()
}
},movie.name="tile_rates_12_18_2016.gif",ani.width = 650, ani.height = 800)
getwd()
oopt = ani.options(interval = 0.15)
saveGIF({for (i in seq(2001,2016,1)) {
g<-multiplot(diff.plot(y)+labs(caption=""),tile.plot(y)+theme(legend.position="none"),
layout=matrix(c(1,2,2), nrow=3, byrow=TRUE))
print(g)
ani.pause()
}
for (i2 in 1:10) {
g<- multiplot(diff.plot(y)+labs(caption=""),tile.plot(y)+theme(legend.position="none"),
layout=matrix(c(1,2,2), nrow=3, byrow=TRUE))
print(g)
ani.pause()
}
},movie.name="tile_rates_12_18_2016.gif",ani.width = 650, ani.height = 800)
oopt = ani.options(interval = 0.15)
saveGIF({for (i in seq(2001,2016,1)) {
g<-multiplot(diff.plot(i)+labs(caption=""),tile.plot(i)+theme(legend.position="none"),
layout=matrix(c(1,2,2), nrow=3, byrow=TRUE))
print(g)
print(i)
ani.pause()
}
for (i2 in 1:10) {
g<- multiplot(diff.plot(2016)+labs(caption=""),tile.plot(2016)+theme(legend.position="none"),
layout=matrix(c(1,2,2), nrow=3, byrow=TRUE))
print(g)
ani.pause()
}
},movie.name="tile_rates_12_18_2016.gif",ani.width = 650, ani.height = 800)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
ggplot(data=pmms30yr[year>2000,],aes(x=date,y=d52,color=d52,fill=rate))+
geom_col()+
scale_fill_viridis(name="52-week\nChange (pp)",discrete=F,option="B")+
scale_color_viridis(name="52-week\nChange (pp)",discrete=F,option="B")+
theme_minimal()+
theme(axis.text.x=element_text(size=6))+
labs(x="", y="",
title="52-week change in 30-year Fixed Mortgage Rate",
#subtitle="52-week change in mortgage rates",
caption="@lenkiefer Source: Freddie Mac Primary Mortgage Market Survey")+
scale_x_date(date_breaks="1 year",date_label="%Y")+
theme(plot.title=element_text(size=14))+
theme(axis.text=element_text(size=8))+
theme(plot.caption=element_text(hjust=0), legend.position="none")
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
g.tile<-
ggplot(data=pmms30yr[year>2000,],aes(x=id,y=yearf,color=d52,fill=d52))+
geom_tile(color="gray")+
scale_x_continuous(breaks=seq(0,50,10))+
scale_fill_viridis(name="52-week\nChange (pp)",discrete=F,option="B")+
scale_color_viridis(name="52-week\nChange (pp)",discrete=F,option="B")+
theme_minimal()+labs(x="week of year",y="year",
title="Annual change in 30-year fixed mortgage rates",
subtitle="52-week change in rates",
caption="@lenkiefer Source: Freddie Mac Primary Mortgage Market Survey")+
theme(legend.position="top",plot.caption=element_text(hjust=0))+
theme(axis.text.y=element_text(size=6),
axis.text.x=element_text(size=6))
g.tile
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
# make tables for viewing formatting dates with purr %>% operations
htmlTable(tail(pmms30yr %>% map_if(is.Date, as.character,format="%b %d,%Y") %>% map_if(is.numeric, round,3) %>%as.data.frame() ,10), col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate (%)",
tfoot="Source: Freddie Mac Primary Mortgage Market Survey")
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
mtcars
names(mtcars)
names(mtcars,2)
rownames(mtcars)
myf<-function(i){
out.df<-mtcars
out.df$id<-0
out.df[i,]$id<-1
}
myf(1)
myf(1)
myf<-function(i){
out.df<-mtcars
out.df$id<-0
out.df[i,]$id<-1
return(out.df)
}
myf(1)
nrows(mtcars)
lenght(mtcars)
length(mtcars)
rows(mtcars)
str(mtcars)
mylist<-lapply(myf,seq(1,32))
lapply
?lapply
mylist<-lapply(seq(1,32,1),myf)
mylist
tween.df<-tween_states(my.list,tween_length=2,statelength=3, ease=rep('cubic-in-out',200), nframes=225)
tween.df<-tween_states(my.list,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=225)
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(my.list,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=225)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=225)
tween.df
str(tween.df)
max(tween.df$.frame)
ggplot(data=filter(tween.df,.frame==i),aes(x=mpg,y=cyl,name=rownames))
ggplot(data=filter(tween.df,.frame==i),aes(x=mpg,y=cyl))+geom_point()
ggplot(data=filter(tween.df,.frame==i),aes(x=mpg,y=cyl))+geom_point()
i
i<-1
ggplot(data=filter(tween.df,.frame==i),aes(x=mpg,y=cyl))+geom_point()
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg))+geom_point()
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,color=id))+geom_point()
myf<-function(i){
out.df<-mtcars
out.df$id<-"blue"
out.df[i,]$id<-"red"
return(out.df)
}
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=225)
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,color=id))+geom_point()
filter(tween.df,.frame==i)
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=225)
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,color=id))+geom_point()
tween.df$.frame
tween.df$id
myf<-function(i){
out.df<-mtcars
out.df$id<-factor("blue")
out.df[i,]$id<-factor("red")
return(out.df)
}
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=225)
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,color=id))+geom_point()
df<-mtcars
myf<-function(i){
out.df<-mtcars
out.df$id<-"blue"
out.df[i,]$id<-"red"
out.df$id<-as.factor(out.df$id)
return(out.df)
}
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=225)
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,color=id))+geom_point()
tween.df,.frame==i)
filter(tween.df,.frame==i)
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,color=id,size=id))+geom_point()
myf<-function(i){
out.df<-mtcars
out.df$id<-"red"
out.df[i,]$id<-"blue"
out.df$id<-as.factor(out.df$id)
return(out.df)
}
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=225)
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,color=id,size=id))+geom_point()
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,color=id))+geom_point(alpha=0.5)
i<-10
mtcars
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,color=id,size=disp))+geom_point(alpha=0.5)
oopt = ani.options(interval = 0.1)
saveGIF({for (i in 1:max(tf$.frame)) {
g<-ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,color=id))+geom_point(alpha=0.5,size=3)
print(g)
ani.pause()
}
},movie.name="test mtcars tween.gif",ani.width = 840, ani.height =450)
max(tween.df$.frame)
nrows(mtcars)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=150)
max(tween.df$.frame
)
oopt = ani.options(interval = 0.1)
saveGIF({for (i in 1:max(tween.df$.frame)) {
g<-ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,color=id))+geom_point(alpha=0.5,size=3)
print(g)
ani.pause()
}
},movie.name="test mtcars tween.gif",ani.width = 840, ani.height =450)
getwd()
rows(df)
rownames(mtcars)
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,color=id))+geom_point(alpha=0.5,size=3)+
labs(title=rownames(mtcars)[i])
i<-3
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,color=id))+geom_point(alpha=0.5,size=3)+
labs(title=rownames(mtcars)[i])
myf<-function(i){
out.df<-mtcars
out.df$id<-0.2
out.df[i,]$id<-1
#out.df$id<-as.factor(out.df$id)
return(out.df)
}
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=150)
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id))+geom_point(alpha=0.5,size=3)+
labs(title=rownames(mtcars)[i])
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id))+geom_point(size=3)+
labs(title=rownames(mtcars)[i])
myf<-function(i){
out.df<-mtcars
out.df$id<-0.05
out.df[i,]$id<-1
out.df$label<-""
out.df[i,]<-rownames(mtcars[i])
#out.df$id<-as.factor(out.df$id)
return(out.df)
}
myf(3)
myf<-function(i){
out.df<-mtcars
out.df$id<-0.05
out.df[i,]$id<-1
out.df$label<-""
out.df[i,]<-rownames(mtcars)[i]
#out.df$id<-as.factor(out.df$id)
return(out.df)
}
myf(3)
myf<-function(i){
out.df<-mtcars
out.df$id<-"red"
out.df[i,]$id<-"blue"
out.df$id<-as.factor(out.df$id)
return(out.df)
}
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=150)
myplot<-function(i){
g<-ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id))+geom_point(size=3)+
labs(title=rownames(mtcars)[i])
return(g)
}
myplot(1)
myplot<-function(i){
g<-ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id,color=id))+geom_point(size=3)+
labs(title=rownames(mtcars)[i])
return(g)
}
myplot(1)
library(tweenr)
library(animation)
library(ggplot2)
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id,color=id))+geom_point(size=3)+
labs(title=rownames(mtcars)[i])
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id,color=id))+geom_point(size=3)+
labs(title=rownames(mtcars)[i])+theme_base()
ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id,color=id))+geom_point(size=3)+
labs(title=rownames(mtcars)[i])+theme_bw()
myf<-function(i){
out.df<-mtcars
out.df$id<-"blue"
out.df[i,]$id<-"red"
out.df$id<-as.factor(out.df$id)
return(out.df)
}
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=150)
myplot<-function(i){
g<-ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id,color=id))+geom_point(size=3)+
labs(title=rownames(mtcars)[i])+theme_bw()
return(g)
}
myf<-function(i){
out.df<-mtcars
out.df$id<-"blue"
out.df[i,]$id<-"red"
out.df$name<-as.factor(rownames(df)[i])
out.df$id<-as.factor(out.df$id)
return(out.df)
}
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=150)
myplot<-function(i){
g<-ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id,color=id))+geom_point(size=3)+
labs(title=filter(tween.df,.frame==i)$name)+theme_bw()
return(g)
}
myplot(1)
myf<-function(i){
out.df<-mtcars
out.df$id<-"blue"
out.df[i,]$id<-"red"
out.df$name<-as.factor(rownames(df)[i])
out.df$id<-as.factor(out.df$id)
return(out.df)
}
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=150)
myplot<-function(i){
g<-ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id,color=id))+geom_point(size=3)+
labs(title=filter(tween.df,.frame==i)$name)+theme_bw()
return(g)
}
myplot(2)
myf<-function(i){
out.df<-mtcars
out.df$id<-"red"
out.df[i,]$id<-"blue"
out.df$name<-as.factor(rownames(df)[i])
out.df$id<-as.factor(out.df$id)
return(out.df)
}
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=150)
myplot<-function(i){
g<-ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id,color=id))+geom_point(size=3)+
labs(title=filter(tween.df,.frame==i)$name)+theme_bw()
return(g)
}
myplot(1)
myf<-function(i){
out.df<-mtcars
out.df$id<-"others"
out.df[i,]$id<-"highlighted"
out.df$name<-as.factor(rownames(df)[i])
out.df$id<-as.factor(out.df$id)
return(out.df)
}
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=150)
myplot<-function(i){
g<-ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id,color=id))+geom_point(size=3)+
labs(title=filter(tween.df,.frame==i)$name)+theme_bw()
return(g)
}
myplot(1)
myf<-function(i){
out.df<-mtcars
out.df$id<-"those"
out.df[i,]$id<-"this"
out.df$name<-as.factor(rownames(df)[i])
out.df$id<-as.factor(out.df$id)
return(out.df)
}
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=150)
myplot<-function(i){
g<-ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id,color=id))+geom_point(size=3)+
labs(title=filter(tween.df,.frame==i)$name)+theme_bw()
return(g)
}
myplot(1)
myf<-function(i){
out.df<-mtcars
out.df$id<-"all others"
out.df[i,]$id<-"highlighted"
out.df$name<-as.factor(rownames(df)[i])
out.df$id<-as.factor(out.df$id)
return(out.df)
}
mylist<-lapply(seq(1,32,1),myf)
tween.df<-tween_states(mylist,tweenlength=2,statelength=3, ease=rep('cubic-in-out',200), nframes=150)
myplot<-function(i){
g<-ggplot(data=filter(tween.df,.frame==i),aes(x=hp,y=mpg,alpha=id,color=id))+geom_point(size=3)+
labs(title=filter(tween.df,.frame==i)$name)+theme_bw()
return(g)
}
myplot(1)
oopt = ani.options(interval = 0.1)
saveGIF({for (i in 1:max(tween.df$.frame)) {
g<-myplot(i)
print(g)
ani.pause()
}
},movie.name="test mtcars tween.gif",ani.width = 840, ani.height =450)
id
mtcars
filter(tween.df,.frame==i)
ggplot(data=filter(tween.df,.frame==i),aes(x=plot.value,y=row.names(filter(tween.df,.frame==i))))+
geom_col()
myf<-function(i){
out.df<-mtcars
out.df$y<-mtcars[,i]
return(out.df)
}
myf(1)
column.names
names(df)
i
i<-3
names(df)[i]
mylist<-lapply(seq(1,1,1),myf)
tween.df<-tween_states(mylist,tweenlength=1,statelength=2, ease=rep('cubic-in-out',11), nframes=33)
mylist<-lapply(seq(11,1),myf)
tween.df<-tween_states(mylist,tweenlength=1,statelength=2, ease=rep('cubic-in-out',11), nframes=33)
tween.df
head(tween.df)
myf<-function(i){
out.df<-mtcars
out.df$y<-mtcars[,i]
out.df$yname<-as.factor(names(df)[i])
return(out.df)
}
myf(3)
myf(4)
mylist<-lapply(seq(11,1),myf)
tween.df<-tween_states(mylist,tweenlength=1,statelength=2, ease=rep('cubic-in-out',11), nframes=33)
myplot<-function(i){
g<-ggplot(data=filter(tween.df,.frame==i),aes(x=mpg,y=y))+geom_point(size=3)+theme_bw()
return(g)
}
myplot(3)
myplot(4)
myplot<-function(i){
g<-ggplot(data=filter(tween.df,.frame==i),aes(x=mpg,y=y))+geom_point(size=3)+theme_bw()
return(g)
}
dev.off()
dev.off()
dev.off()
dev.off()
