ggplot(data=dm3[metro.pop>2387138],aes(y=Value,
label=Value,                                       x=reorder(cbsa.name,Value),fill=Value))+geom_col()+
theme_bw()+
coord_flip()+scale_fill_viridis()+geom_text(hjust=1)+  base_breaks_y0(dm3[metro.pop>2387138]$Value)+
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.ticks.length=unit(0.25,"cm")
)
dm2[,vs:=scale(Value),]
dm2[,val2:=9+9*(log(Value)-5.275)]
ggplot(data=dm2[metro.pop>2387138 & date=="2016-12-31" & freq=a],aes(y=Value,
label=Value,                                       x=reorder(cbsa.name,Value),fill=Value))+geom_col()+
theme_bw()+
coord_flip()+scale_fill_viridis()+geom_text(hjust=1)+  base_breaks_y0(dm3[metro.pop>2387138]$Value)+
theme(panel.border = element_blank(),
legend.position="none",
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.ticks.length=unit(0.25,"cm"))
dm2<-merge(dt,d,by.y="cbsa",by.x="cbsa",all.x=T)
dm2[,vs:=scale(Value),]
dm2[,val2:=9+9*(log(Value)-5.275)]
ggplot(data=dm2[metro.pop>2387138 & date=="2016-12-31" & freq=a],aes(y=Value,
label=Value,                                       x=reorder(cbsa.name,Value),fill=Value))+geom_col()+
theme_bw()+
coord_flip()+scale_fill_viridis()+geom_text(hjust=1)+  base_breaks_y0(dm3[metro.pop>2387138]$Value)+
theme(panel.border = element_blank(),
legend.position="none",
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.ticks.length=unit(0.25,"cm"))
ggplot(data=dm2[metro.pop>2387138 & date=="2016-12-31" & freq=="a"],aes(y=Value,
label=Value,                                       x=reorder(cbsa.name,Value),fill=Value))+geom_col()+
theme_bw()+
coord_flip()+scale_fill_viridis()+geom_text(hjust=1)+  base_breaks_y0(dm3[metro.pop>2387138]$Value)+
theme(panel.border = element_blank(),
legend.position="none",
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.ticks.length=unit(0.25,"cm"))
ggplot(data=dm2[metro.pop>2387138 & date=="2016-12-31" & freq=="a"],aes(y=Value,
label=Value,                                       x=reorder(cbsa.name,Value),fill=Value))+geom_col()+
theme_bw()+
coord_flip()+scale_fill_viridis()+geom_text(hjust=1)+  base_breaks_y0(dm3[metro.pop>2387138]$Value)+
theme(panel.border = element_blank(),
legend.position="none",
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.ticks.length=unit(0.25,"cm"))+
labs(x="",y="Median Sales Price (log scale)",
title="House prices highest in coastal markets",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")
ggplot(data=dm2[metro.pop>2387138 & date=="2016-12-31" & freq=="a"],aes(y=Value,
label=Value,                                       x=reorder(cbsa.name,Value),fill=Value))+geom_col()+
theme_bw()+
coord_flip()+scale_fill_viridis()+geom_text(hjust=1)+  base_breaks_y0(dm3[metro.pop>2387138]$Value)+
theme(panel.border = element_blank(),
legend.position="none",
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.ticks.length=unit(0.25,"cm"))+
labs(x="",y="Median Sales Price (log scale)",
title="House prices highest in coastal markets",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")
ggplot(data=dm2[metro.pop>2387138 & date=="2016-12-31" & freq=="a"],aes(y=Value,
label=paste0("$",round(Value,0),"k"),                                       x=reorder(cbsa.name,Value),fill=Value))+geom_col()+
theme_bw()+
coord_flip()+scale_fill_viridis()+geom_text(hjust=1)+  base_breaks_y0(dm3[metro.pop>2387138]$Value)+
theme(panel.border = element_blank(),
legend.position="none",
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.ticks.length=unit(0.25,"cm"))+
labs(x="",y="Median Sales Price (log scale)",
title="House prices highest in coastal markets",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")
ggplot(data=dm2[metro.pop>2387138 & date=="2016-12-31" & freq=="a"],aes(y=Value,
label=paste0("$",round(Value,0),"k"),                                       x=reorder(cbsa.name,Value),fill=Value))+geom_col()+
theme_bw()+
coord_flip()+scale_fill_viridis()+geom_text(hjust=1)+  base_breaks_y0(dm3[metro.pop>2387138]$Value)+
theme(panel.border = element_blank(),
legend.position="none",
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.ticks.length=unit(0.25,"cm"))+
labs(x="",y="Median Sales Price",
title="House prices in large metro areas",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
ggplot(data=dm2[metro.pop>2387138 & date=="2016-12-31" & freq=="a"],aes(y=Value,
label=paste0("$",round(Value,0),"k"),                                       x=reorder(cbsa.name,Value),fill=Value))+geom_col()+
theme_bw()+
coord_flip()+scale_fill_viridis()+geom_text(hjust=1,color="white")+  base_breaks_y0(dm3[metro.pop>2387138]$Value)+
theme(panel.border = element_blank(),
legend.position="none",
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.ticks.length=unit(0.25,"cm"))+
labs(x="",y="Median Sales Price",
title="House prices in large metro areas",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")
dm3[order(-metro.pop)]
View(dm3[order(-metro.pop)])
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
ggplot(data=dm3,
aes(x = long, y = lat,  colour =vs)) +
borders("state",  colour = "grey70")+geom_point(alpha=0.82,size=3)+
#theme_void()+
scale_y_continuous(limits=c(0,50),breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
scale_x_continuous(limits=c(-125,-65))+
scale_color_viridis(breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
geom_point(aes(y=val2),size=3)+
geom_segment(x=-Inf,xend=-Inf,y=23.6948,yend=1.445107)+
theme_bw()+  theme(legend.position="bottom")+
labs(x="",y="Median Sales Price (log scale)",
title="House prices highest in coastal markets",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")+
#geom_text_repl()
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
text=element_text(family="Palatino Linotype"),
panel.grid.minor = element_blank(),
axis.ticks.x=element_blank(),
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
axis.ticks.length=unit(-0.15,"cm"),
axis.title.y=element_text(size=10,hjust=0.15),
#margin=unit(c(0.5,0,0.0,0.0), "cm")),
axis.text.y = element_text(size=7,margin=unit(c(0,0.250,0.0,0.0), "cm")),
axis.text.x =element_blank()  )
ggplot(data=dm3,
aes(x = long, y = lat,  colour =vs)) +
borders("state",  colour = "grey70")+geom_point(alpha=0.82,size=3)+
#theme_void()+
scale_y_continuous(limits=c(0,50),breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
scale_x_continuous(limits=c(-125,-65))+
scale_color_viridis(values=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
geom_point(aes(y=val2),size=3)+
geom_segment(x=-Inf,xend=-Inf,y=23.6948,yend=1.445107)+
theme_bw()+  theme(legend.position="bottom")+
labs(x="",y="Median Sales Price (log scale)",
title="House prices highest in coastal markets",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")+
#geom_text_repl()
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
text=element_text(family="Palatino Linotype"),
panel.grid.minor = element_blank(),
axis.ticks.x=element_blank(),
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
axis.ticks.length=unit(-0.15,"cm"),
axis.title.y=element_text(size=10,hjust=0.15),
#margin=unit(c(0.5,0,0.0,0.0), "cm")),
axis.text.y = element_text(size=7,margin=unit(c(0,0.250,0.0,0.0), "cm")),
axis.text.x =element_blank()  )
ggplot(data=dm3,
aes(x = long, y = lat,  colour =vs)) +
borders("state",  colour = "grey70")+geom_point(alpha=0.82,size=3)+
#theme_void()+
scale_y_continuous(limits=c(0,50),breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
scale_x_continuous(limits=c(-125,-65))+
scale_color_viridis(values=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
geom_point(aes(y=val2),size=3)+
geom_segment(x=-Inf,xend=-Inf,y=23.6948,yend=1.445107)+
theme_bw()+  theme(legend.position="bottom")+
labs(x="",y="Median Sales Price (log scale)",
title="House prices highest in coastal markets",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")+
#geom_text_repl()
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
text=element_text(family="Palatino Linotype"),
panel.grid.minor = element_blank(),
axis.ticks.x=element_blank(),
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
axis.ticks.length=unit(-0.15,"cm"),
axis.title.y=element_text(size=10,hjust=0.15),
#margin=unit(c(0.5,0,0.0,0.0), "cm")),
axis.text.y = element_text(size=7,margin=unit(c(0,0.250,0.0,0.0), "cm")),
axis.text.x =element_blank()  )
?scale_color_viridis
ggplot(data=dm3,
aes(x = long, y = lat,  colour =vs)) +
borders("state",  colour = "grey70")+geom_point(alpha=0.82,size=3)+
#theme_void()+
scale_y_continuous(limits=c(0,50),breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
scale_x_continuous(limits=c(-125,-65))+
scale_color_viridis(values=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))
ggplot(data=dm3,
aes(x = long, y = lat,  colour =vs)) +
borders("state",  colour = "grey70")+geom_point(alpha=0.82,size=3)+
#theme_void()+
scale_y_continuous(limits=c(0,50),breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
scale_x_continuous(limits=c(-125,-65))+
scale_color_viridis(breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))
summary(d3$va2)
summary(d3$val2)
summary(dm3$val2)
ggplot(data=dm3,
aes(x = long, y = lat,  colour =vs)) +
borders("state",  colour = "grey70")+geom_point(alpha=0.82,size=3)+
#theme_void()+
scale_y_continuous(limits=c(0,50),breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
scale_x_continuous(limits=c(-125,-65))+
scale_color_viridis(breaks=c( 1.445,8.576054, 23.69),
labels=c("$84k","$186k","$1M"))+
geom_point(aes(y=val2),size=3)+
geom_segment(x=-Inf,xend=-Inf,y=23.6948,yend=1.445107)+
theme_bw()+  theme(legend.position="bottom")+
labs(x="",y="Median Sales Price (log scale)",
title="House prices highest in coastal markets",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")+
#geom_text_repl()
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
text=element_text(family="Palatino Linotype"),
panel.grid.minor = element_blank(),
axis.ticks.x=element_blank(),
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
axis.ticks.length=unit(-0.15,"cm"),
axis.title.y=element_text(size=10,hjust=0.15),
#margin=unit(c(0.5,0,0.0,0.0), "cm")),
axis.text.y = element_text(size=7,margin=unit(c(0,0.250,0.0,0.0), "cm")),
axis.text.x =element_blank()  )
ggplot(data=dm3,
aes(x = long, y = lat,  colour =vs)) +
borders("state",  colour = "grey70")+geom_point(alpha=0.82,size=3)+
#theme_void()+
scale_y_continuous(limits=c(0,50),breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
scale_x_continuous(limits=c(-125,-65))+
scale_color_viridis(breaks=c( 1.445,8.576054, 23.69),
labels=c("$84k","$186k","$1M"))+
geom_point(aes(y=val2),size=3)+
geom_segment(x=-Inf,xend=-Inf,y=23.6948,yend=1.445107)+
theme_bw()+  theme(legend.position="bottom")+
labs(x="",y="Median Sales Price (log scale)",
title="House prices highest in coastal markets",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")+
#geom_text_repl()
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
text=element_text(family="Palatino Linotype"),
panel.grid.minor = element_blank(),
axis.ticks.x=element_blank(),
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
axis.ticks.length=unit(-0.15,"cm"),
axis.title.y=element_text(size=10,hjust=0.15),
#margin=unit(c(0.5,0,0.0,0.0), "cm")),
axis.text.y = element_text(size=7,margin=unit(c(0,0.250,0.0,0.0), "cm")),
axis.text.x =element_blank()  )
ggplot(data=dm3,
aes(x = long, y = lat,  colour =vs)) +
borders("state",  colour = "grey70")+geom_point(alpha=0.82,size=3)+
#theme_void()+
scale_y_continuous(limits=c(0,50),breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
scale_x_continuous(limits=c(-125,-65))+
scale_color_viridis(breaks=c( 1.4,8.576054, 23.5),
labels=c("$84k","$186k","$1M"))+
geom_point(aes(y=val2),size=3)+
geom_segment(x=-Inf,xend=-Inf,y=23.6948,yend=1.445107)+
theme_bw()+  theme(legend.position="bottom")+
labs(x="",y="Median Sales Price (log scale)",
title="House prices highest in coastal markets",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")+
#geom_text_repl()
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
text=element_text(family="Palatino Linotype"),
panel.grid.minor = element_blank(),
axis.ticks.x=element_blank(),
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
axis.ticks.length=unit(-0.15,"cm"),
axis.title.y=element_text(size=10,hjust=0.15),
#margin=unit(c(0.5,0,0.0,0.0), "cm")),
axis.text.y = element_text(size=7,margin=unit(c(0,0.250,0.0,0.0), "cm")),
axis.text.x =element_blank()  )
9+9*(log(100)-5.275)
ggplot(data=dm3,
aes(x = long, y = lat,  colour =vs)) +
borders("state",  colour = "grey70")+geom_point(alpha=0.82,size=3)+
#theme_void()+
scale_y_continuous(limits=c(0,50),breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
scale_x_continuous(limits=c(-125,-65))+
scale_color_viridis(name="Median Sales Price (lot scale)",breaks=c( 2.97,8.576054, 23.5),
labels=c("$100k","$186k","$1M"))+
geom_point(aes(y=val2),size=3)+
geom_segment(x=-Inf,xend=-Inf,y=23.6948,yend=1.445107)+
theme_bw()+  theme(legend.position="bottom")+
labs(x="",y="Median Sales Price (log scale)",
title="House prices highest in coastal markets",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")+
#geom_text_repl()
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
text=element_text(family="Palatino Linotype"),
panel.grid.minor = element_blank(),
axis.ticks.x=element_blank(),
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
axis.ticks.length=unit(-0.15,"cm"),
axis.title.y=element_text(size=10,hjust=0.15),
#margin=unit(c(0.5,0,0.0,0.0), "cm")),
axis.text.y = element_text(size=7,margin=unit(c(0,0.250,0.0,0.0), "cm")),
axis.text.x =element_blank()  )
ggplot(data=dm3,
aes(x = long, y = lat,  colour =val2)) +
borders("state",  colour = "grey70")+geom_point(alpha=0.82,size=3)+
#theme_void()+
scale_y_continuous(limits=c(0,50),breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
scale_x_continuous(limits=c(-125,-65))+
scale_color_viridis(name="Median Sales Price (lot scale)",breaks=c( 2.97,8.576054, 23.5),
labels=c("$100k","$186k","$1M"))+
geom_point(aes(y=val2),size=3)+
geom_segment(x=-Inf,xend=-Inf,y=23.6948,yend=1.445107)+
theme_bw()+  theme(legend.position="bottom")+
labs(x="",y="Median Sales Price (log scale)",
title="House prices highest in coastal markets",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")+
#geom_text_repl()
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
text=element_text(family="Palatino Linotype"),
panel.grid.minor = element_blank(),
axis.ticks.x=element_blank(),
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
axis.ticks.length=unit(-0.15,"cm"),
axis.title.y=element_text(size=10,hjust=0.15),
#margin=unit(c(0.5,0,0.0,0.0), "cm")),
axis.text.y = element_text(size=7,margin=unit(c(0,0.250,0.0,0.0), "cm")),
axis.text.x =element_blank()  )
ggplot(data=dm3,
aes(x = long, y = lat,  colour =val2)) +
borders("state",  colour = "grey70")+geom_point(alpha=0.82,size=3)+
#theme_void()+
scale_y_continuous(limits=c(0,50),breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
scale_x_continuous(limits=c(-125,-65))+
scale_color_viridis(name="Median Sales Price (lot scale)",breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
geom_point(aes(y=val2),size=3)+
geom_segment(x=-Inf,xend=-Inf,y=23.6948,yend=1.445107)+
theme_bw()+  theme(legend.position="bottom")+
labs(x="",y="Median Sales Price (log scale)",
title="House prices highest in coastal markets",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")+
#geom_text_repl()
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
text=element_text(family="Palatino Linotype"),
panel.grid.minor = element_blank(),
axis.ticks.x=element_blank(),
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
axis.ticks.length=unit(-0.15,"cm"),
axis.title.y=element_text(size=10,hjust=0.15),
#margin=unit(c(0.5,0,0.0,0.0), "cm")),
axis.text.y = element_text(size=7,margin=unit(c(0,0.250,0.0,0.0), "cm")),
axis.text.x =element_blank()  )
ggplot(data=dm3,
aes(x = long, y = lat,  colour =val2)) +
borders("state",  colour = "grey70")+geom_point(alpha=0.82,size=3)+
#theme_void()+
scale_y_continuous(limits=c(0,50),breaks=c( 1.445107,8.576054, 23.6948),
labels=c("$84k","$186k","$1M"))+
scale_x_continuous(limits=c(-125,-65))+
scale_color_viridis(name="Median Sales Price (lot scale)",breaks=c( 1.445107,8.576054, 23.69),
labels=c("$84k","$186k","$1M"))+
geom_point(aes(y=val2),size=3)+
geom_segment(x=-Inf,xend=-Inf,y=23.6948,yend=1.445107)+
theme_bw()+  theme(legend.position="bottom")+
labs(x="",y="Median Sales Price (log scale)",
title="House prices highest in coastal markets",
subtitle="Median Sales Price of Existing Single-Family Homes for Metropolitan Areas in 2016",
caption="@lenkiefer Source: National Association of Realtors")+
#geom_text_repl()
theme(panel.border = element_blank(),
panel.grid.major = element_blank(),
text=element_text(family="Palatino Linotype"),
panel.grid.minor = element_blank(),
axis.ticks.x=element_blank(),
plot.caption=element_text(hjust=0),
plot.subtitle=element_text(size=9,face="italic"),
axis.ticks.length=unit(-0.15,"cm"),
axis.title.y=element_text(size=10,hjust=0.15),
#margin=unit(c(0.5,0,0.0,0.0), "cm")),
axis.text.y = element_text(size=7,margin=unit(c(0,0.250,0.0,0.0), "cm")),
axis.text.x =element_blank()  )
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
?read_excel
getwd9)
getwd()
read_excel('data/afford metro 2016Q4.xlsx',sheet= 'Release',skip=11)
read_excel('data/afford metro 2016Q4.xlsx',sheet= 'Release',skip=10)
names(dt)
library(readxl)
library(tidyverse)
library(data.table)
library(viridis)
library(maps)
library(tweenr)
library(animation)
data(us.cities) # from the package maps
dt<-data.table( read_excel('data/afford metro 2016Q4.xlsx',sheet= 'data2'))
bsa.data <-fread("data/cbsa.city.txt")
cbsa.metro<-cbsa.data[metro.micro=="Metropolitan Statistical Area"]
d<-merge(cbsa.metro,us.cities,by="name")
#get rid of duplicates
# see: http://stackoverflow.com/questions/15776064/r-first-observation-by-group-using-data-table-self-join
d<-d[order(-pop)]
d<-d[d[,list(row1 = .I[1]), by = list(cbsa)][,row1]]
setkey(d,cbsa.name)
setkey(dt,metro)
cbsa.list<-unique(d$cbsa.name)
dm2<-merge(dt,d,by.y="cbsa",by.x="cbsa",all.x=T)
dm2[,vs:=scale(Value),]
dm2[,val2:=9+9*(log(Value)-5.275)]
### Functions for better axis
base_breaks_y <- function(x){
b <- pretty(x)
d <- data.frame(x=-Inf, xend=-Inf, y=min(b), yend=max(b))
list(geom_segment(data=d, aes(x=x, y=y, xend=xend, yend=yend), inherit.aes=FALSE),
scale_y_continuous(breaks=b))
}
read_excel('data/afford metro 2016Q4.xlsx',sheet= 'Release',skip=10,col_names=c("cbsa","metro","y2014","y2015","y2016"))
read_excel('data/afford metro 2016Q4.xlsx',sheet= 'Release',skip=10,col_names=c("cbsa","metro","y2014","y2015","y2016"))
read_excel('data/afford metro 2016Q4.xlsx',sheet= 'Release',skip=10,col_names=F)
read_excel('data/afford metro 2016Q4.xlsx',sheet= 'Release',skip=10,col_names=c("cbsa","metro","y2014","y2015","y2016",
"Q42015","Q12016","Q22016","Q32016","Q42016","PC"))
read_excel('data/afford metro 2016Q4.xlsx',sheet= 'Release',skip=10,col_names=c("cbsa","metro","y2014","y2015","y2016","Q42015", "Q12016","Q22016","Q32016","Q42016","PC"))
read_excel('data/afford metro 2016Q4.xlsx',sheet= 'Release',skip=10,col_names=c("cbsa","metro","y2014","y2015","y2016","Q42015", "Q12016","Q22016","Q32016","Q42016","PC"),col_types=NULL)
read_excel('data/afford metro 2016Q4.xlsx',sheet= 'Release',skip=10,col_names=F)
df<-read_excel('data/afford metro 2016Q4.xlsx',sheet= 'Release',skip=10,col_names=F)
df
df<-read_excel('data/afford metro 2016Q4.xlsx',sheet= 'Release',skip=9,col_names=F)
df<-read_excel('data/afford metro 2016Q4.xlsx',sheet= 'Release',skip=9,col_names=F)
df
df<-rename(df,cbsa=X0)
df
df<-read_excel('data/afford metro 2016Q4.xlsx',sheet= 'Release',skip=9,col_names=F)
df<-rename(df,cbsa=X0)
df<-rename(df,metro=X1)
df<-rename(df,Value=X4)
### Only keep the columns we need:
df<-df[,c("cbsa","metro","Value")]
df
dt
cbsa.data
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
ggplot(data=dm,
aes(x = long, y = lat,  colour =val2)) +
borders("state",  colour = "grey70")+geom_point(alpha=0.82,size=3)
summary(dm)
log(84)
log(84)-5.275
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
