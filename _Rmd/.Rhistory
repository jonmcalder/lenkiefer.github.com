mdata<-read_excel("data/chartbook aug 2016.xlsx",sheet="mrate")
mdata$date<-as.Date(mdata$date, format="%m/%d/%Y")
mdata
setwd('C:/Users/Leonard/Documents/Data Viz/blog/pmms')
pmms30yr <- read.delim("~/Data Viz/blog/pmms/pmms30yr3.txt")
pmms30yr$date<-as.Date(pmms30yr$date, format="%m/%d/%Y")
require("animation")
library("ggplot2")
library("scales")
require('ggthemes')
source("C:/Users/Leonard/Documents/Data Viz/blog/myggplot2.R")
library(data.table)
pmms30yr<-data.table(pmms30yr)
i0<-nrow(pmms30yr)
pmms30yr$x=pmms30yr$date
pmms30yr$y=pmms30yr$rate
pmms30yr$slabel=pmms30yr$rate
#choose starting point
istart<-576
istart<-nrow(pmms30yr[date<'2015-12-31'])+1
i<-nrow(pmms30yr)
pd<-pmms30yr[date>='2015-12-31']
#get max week numbers in 2016
N<-max(pmms30yr[year==2016,]$week)
oopt = ani.options(interval = 0.15)
saveGIF({for (i in 1:N) {
g<-
ggplot(data=pmms30yr[date>='2015-12-31' & week<=i], aes(x=date,y=rate,label=rate))+geom_line()+theme_minimal()+
theme(legend.position="none")+
#scale_x_continuous(limits=c(0,20))+
#scale_y_continuous(limits=c(3.,4))+
scale_x_date(date_breaks="1 month", date_labels="%b-%Y")+
scale_y_continuous(limits=c(3,4),breaks=seq(3,4,.1))+
geom_text(data=pmms30yr[date>='2015-12-31' & week==i],nudge_x=10)+
geom_point(data=pmms30yr[date>='2015-12-31' & week==i],size=2,color="red",alpha=0.75)+
labs(x="", y="Mortgage Rate (%)",
title="30-year Fixed Mortgage Rate (%)",
subtitle="weekly rates in 2016",
caption="@lenkiefer Source: Freddie Mac Primary Mortgage Market Survey")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
coord_cartesian(xlim=c(as.Date("2015-12-31"),as.Date("2016-8-31")), y=c(3.3,4))
print(g)
ani.pause()
}
for (i2 in 1:20) {
print(g)
ani.pause()
}
#},movie.name="rate_7_29_2016.gif",ani.width = 500, ani.height = 350)
},movie.name="rate_8_26_2016.gif",ani.width = 500, ani.height = 350)
head(mdata)
mdata[,list("date","rate")]
mdata[,list(date,rate)]
data.table(mdata)[,list(date,rate)]
data.table(mdata)[year(date)==2016,list(date,rate)]
print.table<-data.table(mdata)[year(date)==2016,list(date,rate)]
htmlTable(print.table, header=c("Year","Rank at 50%","Total Counties","% for 50%"),
col.rgroup = c("none", "#F7F7F7"),caption="How many counties comprise 50% of U.S. population?",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[year(date)==2016,list(date,rate)]
htmlTable(print.table,
col.rgroup = c("none", "#F7F7F7"),caption="How many counties comprise 50% of U.S. population?",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[year(date)==2016,list(as.character(date),rate)]
htmlTable(print.table,
col.rgroup = c("none", "#F7F7F7"),caption="How many counties comprise 50% of U.S. population?",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[year(date)==2016,list(as.character(date,format="%b/%d/%Y"),rate)]
htmlTable(print.table,
col.rgroup = c("none", "#F7F7F7"),caption="How many counties comprise 50% of U.S. population?",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,list(as.character(date,format="%B %d %Y"),rate)]
htmlTable(print.table,
col.rgroup = c("none", "#F7F7F7"),caption="How many counties comprise 50% of U.S. population?",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
?htmlTable
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,list(as.character(date,format="%B %d %Y"),rate)]
htmlTable(print.table,forwnames=F,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,list(as.character(date,format="%B %d %Y"),rate)]
htmlTable(print.table,rownames=F,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,list(date=as.character(date,format="%B %d %Y"),rate)]
htmlTable(print.table,rownames=F,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,list(date=as.character(date,format="%B %d %Y"),rate=format(rate, nsmall = 2)]
htmlTable(print.table,rownames=F,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
data.table(mdata)[month(date)>5 & year(date)==2016,list(date=as.character(date,format="%B %d %Y"),rate=format(rate, nsmall = 2)]
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,list(date=as.character(date,format="%B %d %Y"),rate=format(round(rate,2), nsmall = 2)]
htmlTable(print.table,rownames=F,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,list(date=as.character(date,format="%B %d %Y"),rate=format(round(rate,2), nsmall = 2)]
htmlTable(print.table,rownames=F,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,list(date=as.character(date,format="%B %d %Y"),rate=format(round(rate,2), nsmall = 3)]
htmlTable(print.table,rownames=F,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,list(date=as.character(date,format="%B %d %Y"),rate=format(round(rate,3), nsmall = 3)]
htmlTable(print.table,rownames=F,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
data.table(mdata)[month(date)>5 & year(date)==2016,list(date=as.character(date,format="%B %d %Y"),rate=format(round(rate,3), nsmall = 3)]
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(round(rate,3), nsmall = 3))]
htmlTable(print.table,rownames=F,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate), nsmall = 2))]
htmlTable(print.table,rownames=F,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
htmlTable(print.table,rownames=F,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
htmlTable(print.table,rownames=F, header=c("Date","30-year FRM"),
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
htmlTable(print.table,rownames=F, header=c("Date","30-year FRM"),include.rownames = FALSE,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
htmlTable(print.table,rownames=F, header=c("Date","30-year FRM"),rownames = FALSE,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;SOurce: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
htmlTable(print.table,rownames=F, header=c("Date","30-year FRM"),rownames = FALSE,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
htmlTable(print.table,rownames=F, header=c("Date","30-year FRM"),
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
htmlTable(print.table,rownames=F, header=c("Date","30-year FRM"),pos.rowlabel="bottom",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))],row.names=print.table$date,
htmlTable(print.table,rownames=F, header=c("Date","30-year FRM"),pos.rowlabel="bottom",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
rownames(print.table)
rownames(print.table)<-print.table$date
rownames(print.table)
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
#rownames(print.table)<-print.table$date
htmlTable(print.table,rownames=F, header=c("Date","30-year FRM"),pos.rowlabel="bottom",
row.names=print.table$date,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
htmlTable(print.table,rownames=F, header=c("Date","30-year FRM"),pos.rowlabel="bottom",
row.names=print.table$date,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
htmlTable(print.table,rownames=F, header=c("Date","30-year FRM"),pos.rowlabel="bottom",
row.names=print.table$date,rowlabel="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
htmlTable(print.table$rate,rownames=F, header=c("Date","30-year FRM"),pos.rowlabel="bottom",
row.names=print.table$date,rowlabel="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
htmlTable(print.table$rate,rownames=F, header=c("30-year FRM"),pos.rowlabel="bottom",
row.names=print.table$date,rowlabel="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
htmlTable(print.table$rate, header=c("30-year FRM"),
row.names=print.table$date,rowlabel="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
htmlTable(print.table$rate, header=c("30-year FRM"),
row.names=print.table$date,rowlabel="Date",rownames=T,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
htmlTable(print.table$rate, header=c("30-year FRM"),
row.names=print.table$date,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
htmlTable(print.table$rate, header=c("30-year FRM"),
row.names=print.table$date,rownames=T,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
htmlTable(print.table, header=c("30-year FRM"),
row.names=print.table$date,rownames=T,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
htmlTable(print.table, header=c("Date","30-year FRM"),
row.names=print.table$date,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
#rownames(print.table)<-print.table$date
htmlTable(print.table, header=c("Date","30-year FRM"),
row.names=print.table$date,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
#rownames(print.table)<-print.table$date
htmlTable(print(print.table, row.names = FALSE), header=c("Date","30-year FRM"),
row.names=print.table$date,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
#rownames(print.table)<-print.table$date
htmlTable(print.table, header=c("Date","30-year FRM"),
row.names=print.table$date,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
#rownames(print.table)<-print.table$date
htmlTable(print.table, header=c("Date","30-year FRM"),
row.names=print.table$date,rownames=F,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
print.table$date<-NULL
htmlTable(print.table, header=c("30-year FRM"),
row.names=print.table$date,rownames=F,
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
print.table$date<-NULL
htmlTable(print.table, header=c("30-year FRM"),
row.names=print.table$date,rownames=F,row.label="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
print.table$date<-NULL
htmlTable(print.table, header=c("30-year FRM"),
row.names=print.table$date,rownames=T,row.label="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
print.table$date<-NULL
htmlTable(print.table, header=c("30-year FRM"),
row.names=print.table$date,row.label="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
print.table$date<-NULL
htmlTable(print.table, header=c("30-year FRM"),
row.names=print.table$date,row.label="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[month(date)>5 & year(date)==2016,
list(date=as.character(date,format="%B %d, %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
print.table$date<-NULL
htmlTable(print.table, header=c("30-year FRM"),
row.names=print.table$date,row.label="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[date>as.DATE("06-22-2016"),
list(date=as.character(date,format="%B %d, %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
print.table$date<-NULL
htmlTable(print.table, header=c("30-year FRM"),
row.names=print.table$date,row.label="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[date>as.Date("06-22-2016"),
list(date=as.character(date,format="%B %d, %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
print.table$date<-NULL
htmlTable(print.table, header=c("30-year FRM"),
row.names=print.table$date,row.label="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
data.table(mdata)[date>as.Date("06-22-2016"),
list(date=as.character(date,format="%B %d, %Y"),
rate=format(rate, nsmall = 2))]
mdata
print.table<-data.table(mdata)[date>as.Date("2016-06-22"),
list(date=as.character(date,format="%B %d, %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
print.table$date<-NULL
htmlTable(print.table, header=c("30-year FRM"),
row.names=print.table$date,row.label="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rate",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[date>as.Date("2016-06-22"),
list(date=as.character(date,format="%B %d, %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
print.table$date<-NULL
htmlTable(print.table, header=c("30-year FRM"),
row.names=print.table$date,row.label="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year Fixed Mortgage Rates since Brexit",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
print.table<-data.table(mdata)[date>as.Date("2016-06-22"),
list(date=as.character(date,format="%B %d, %Y"),
rate=format(rate, nsmall = 2))]
rownames(print.table)<-print.table$date
print.table$date<-NULL
htmlTable(print.table, header=c("30-year FRM"),
row.names=print.table$date,row.label="Date",
col.rgroup = c("none", "#F7F7F7"),caption="30-year fixed mortgage rates since Brexit",
tfoot="&dagger;Source: Freddie Mac Primary Mortgage Market Survey")
KnitPost <- function(site.path='/pathToYourBlog/', overwriteAll=F, overwriteOne=NULL) {
if(!'package:knitr' %in% search()) library('knitr')
## Blog-specific directories.  This will depend on how you organize your blog.
site.path <- site.path # directory of jekyll blog (including trailing slash)
rmd.path <- paste0(site.path, "_Rmd") # directory where your Rmd-files reside (relative to base)
fig.dir <- "img/Rfig/" # directory to save figures
posts.path <- paste0(site.path, "_posts/") # directory for converted markdown files
cache.path <- paste0(site.path, "_cache/") # necessary for plots
render_jekyll(highlight = "pygments")
opts_knit$set(base.url = '/', base.dir = site.path)
opts_chunk$set(fig.path=fig.dir, fig.width=8.5, fig.height=5.25, dev='svg', cache=F,
warning=F, message=F, cache.path=cache.path, tidy=F)
setwd(rmd.path) # setwd to base
# some logic to help us avoid overwriting already existing md files
files.rmd <- data.frame(rmd = list.files(path = rmd.path,
full.names = T,
pattern = "\\.Rmd$",
ignore.case = T,
recursive = F), stringsAsFactors=F)
files.rmd$corresponding.md.file <- paste0(posts.path, "/", basename(gsub(pattern = "\\.Rmd$", replacement = ".md", x = files.rmd$rmd)))
files.rmd$corresponding.md.exists <- file.exists(files.rmd$corresponding.md.file)
## determining which posts to overwrite from parameters overwriteOne & overwriteAll
files.rmd$md.overwriteAll <- overwriteAll
if(is.null(overwriteOne)==F) files.rmd$md.overwriteAll[grep(overwriteOne, files.rmd[,'rmd'], ignore.case=T)] <- T
files.rmd$md.render <- F
for (i in 1:dim(files.rmd)[1]) {
if (files.rmd$corresponding.md.exists[i] == F) {
files.rmd$md.render[i] <- T
}
if ((files.rmd$corresponding.md.exists[i] == T) && (files.rmd$md.overwriteAll[i] == T)) {
files.rmd$md.render[i] <- T
}
}
# For each Rmd file, render markdown (contingent on the flags set above)
for (i in 1:dim(files.rmd)[1]) {
if (files.rmd$md.render[i] == T) {
out.file <- knit(as.character(files.rmd$rmd[i]),
output = as.character(files.rmd$corresponding.md.file[i]),
envir = parent.frame(),
quiet = T)
message(paste0("KnitPost(): ", basename(files.rmd$rmd[i])))
}
}
}
library("knitr")
#KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=TRUE, overwriteOne=NULL)
#KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=FALSE, overwriteOne=4)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
mdata
tail(mdata)
i<-34
ggplot(data=mdata[date>='2015-12-31' & week<=i], aes(x=date,y=rate,label=rate))+geom_line()+theme_minimal()+
theme(legend.position="none")+
scale_x_date(date_breaks="1 month", date_labels="%b-%Y")+
scale_y_continuous(limits=c(3,4),breaks=seq(3,4,.1))+
geom_text(data=mdata[date>='2015-12-31' & week==i],nudge_x=10)+
geom_point(data=mdata[date>='2015-12-31' & week==i],size=2,color="red",alpha=0.75)+
labs(x="", y="Mortgage Rate (%)",
title="30-year Fixed Mortgage Rate (%)",
subtitle="weekly rates in 2016",
caption="@lenkiefer Source: Freddie Mac Primary Mortgage Market Survey")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
coord_cartesian(xlim=c(as.Date("2015-12-31"),as.Date("2016-8-31")), y=c(3.3,4))
i<-34
ggplot(data=mdata[year(date)==2016 & week<=i], aes(x=date,y=rate,label=rate))+geom_line()+theme_minimal()+
theme(legend.position="none")+
scale_x_date(date_breaks="1 month", date_labels="%b-%Y")+
scale_y_continuous(limits=c(3,4),breaks=seq(3,4,.1))+
geom_text(data=mdata[date>='2015-12-31' & week==i],nudge_x=10)+
geom_point(data=mdata[date>='2015-12-31' & week==i],size=2,color="red",alpha=0.75)+
labs(x="", y="Mortgage Rate (%)",
title="30-year Fixed Mortgage Rate (%)",
subtitle="weekly rates in 2016",
caption="@lenkiefer Source: Freddie Mac Primary Mortgage Market Survey")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
coord_cartesian(xlim=c(as.Date("2015-12-31"),as.Date("2016-8-31")), y=c(3.3,4))
library(viridis)
library(zoo)
mdata[year(date)==2016 & week<=i]
mdata
mdata[year(date)==2016, ]
library(zoo)
mdata[year(date)==2016, ]
mdata$date
year(mdata$date)
mdata[year(date)==2016, ]
str(mdata)
mdata<-data.table(mdata)
i<-34
ggplot(data=mdata[year(date)==2016, ], aes(x=date,y=rate,label=rate))+geom_line()+theme_minimal()+
theme(legend.position="none")+
scale_x_date(date_breaks="1 month", date_labels="%b-%Y")+
scale_y_continuous(limits=c(3,4),breaks=seq(3,4,.1))+
geom_text(data=mdata[date>='2015-12-31' & week==i],nudge_x=10)+
geom_point(data=mdata[date>='2015-12-31' & week==i],size=2,color="red",alpha=0.75)+
labs(x="", y="Mortgage Rate (%)",
title="30-year Fixed Mortgage Rate (%)",
subtitle="weekly rates in 2016",
caption="@lenkiefer Source: Freddie Mac Primary Mortgage Market Survey")+
theme(plot.title=element_text(size=18))+
theme(plot.caption=element_text(hjust=0,vjust=1,margin=margin(t=10)))+
theme(plot.margin=unit(c(0.25,0.25,0.25,0.25),"cm"))+
coord_cartesian(xlim=c(as.Date("2015-12-31"),as.Date("2016-8-31")), y=c(3.3,4))
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
KnitPost(site.path="C:/Users/Leonard/Documents/webpage/live/lenkiefer.github.com/", overwriteAll=T, overwriteOne=NULL)
