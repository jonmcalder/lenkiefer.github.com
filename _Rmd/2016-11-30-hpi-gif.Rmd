---
layout: post
title: "Comparing house prices, rents, other prices and incomes"
author: "Len Kiefer"
date: "2016-11-30"
summary: "rstats data visualizations, mortgage data"
group: navigation
theme :
  name : lentheme
---

HERE IS A GIF COMPARING house prices, rents, other prices and incomes:

<img src="{{ site.url }}/img/charts_nov_30_2016/house prices vs other prices nov 2016.gif" alt="fhfa hpi gif" />

And a static version with code:

``` {r, fig-fhfa-viz-nov30-1,cache=FALSE,echo=T,eval=T,message=FALSE,warnings=FALSE }
library(tweenr)
library(ggplot2)
library(scales)
library(viridis)
library(animation)
library(dplyr)
library(readxl)
library(data.table)
library("tidyr")

#read in data:
mydata<-read_excel("data/fhfa hpi and income2.xlsx",sheet="data")
mydata$date<-as.Date(mydata$date, format="%m/%d/%Y")

# tidy up the data
mydata %>% gather("var","value",-date) %>%data.table() ->mydata2

#create labels for plot
ind.list<-unique(mydata2$var)[5:8]

mydata2[ , id:= ifelse(
  var == "hpi.100", "House Prices",
  ifelse( 
    var == "noshelter.100","Other Prices",
    ifelse( var== "percapita.100","Income",
            ifelse(var=="rent.100","Rent","other"))))
  ]

# Create caption
mycaption<- "@lenkiefer Source: House Prices: FHFA purchase-only house price index. Rent: U.S. Bureau of Labor Statistics (BLS) consumer price index rent of primary residence. Other Prices: BLS consumer price index all items less shelter. Income: U.S. Bureau of Economic Analysis per capita disposable personal income (Table 2.6.). All are seasonally adjusted."

# Wrap caption 120 characters:
mycaption <- paste0(strwrap(mycaption, 120), sep="", collapse="\n")

# Make plot:
ggplot(data=mydata2[var %in% ind.list ,],aes(x=date,y=value,color=id))+geom_line(size=0.95,alpha=0.82)+
  theme_minimal()+theme(legend.position="none")+scale_y_log10(limits=c(100,250),breaks=seq(100,250,50))+
  scale_x_date(limits=c(min(mydata$date),max(mydata$date)+150),date_labels="%Y",
               breaks=seq(as.Date("1990-01-01"),as.Date("2020-01-01"),"5 year"))+
  scale_color_viridis(discrete=T,option="C",end=0.85)+
  labs(y="Index: Jan, 1991 = 100, log scale",x="",
       title="Comparing house prices to rent, income and other prices",
       caption= mycaption)+theme(plot.caption=element_text(hjust=0,size=10))+
  geom_text(data=mydata2[var %in% ind.list & date==d.list[i],],aes(label=id,color=id),size=4,alpha=0.9)
```